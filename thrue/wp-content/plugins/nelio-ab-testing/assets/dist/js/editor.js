(()=>{var e={4184:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var o=i.apply(null,n);o&&e.push(o)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)r.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{editor:()=>a});var e={};n.r(e),n.d(e,{getActiveGoal:()=>tr,getActiveGoalIndex:()=>nr,getActiveSegment:()=>rr,getActiveSegmentIndex:()=>ir,getAlternative:()=>zn,getAlternativeIds:()=>Qn,getAlternativePreviewerUrl:()=>or,getAlternatives:()=>Jn,getConversionActions:()=>Kn,getDraftStatusRationale:()=>ar,getExperimentAttribute:()=>cr,getExperimentId:()=>sr,getExperimentType:()=>lr,getGoals:()=>dr,getHeatmapAttribute:()=>ur,getScope:()=>pr,getSegmentationRules:()=>vr,getSegments:()=>gr,hasExperimentBeenRecentlySaved:()=>er,isExperimentBeingSaved:()=>Zn,isTestedElementInvalid:()=>mr});var t={};n.r(t),n.d(t,{addAlternatives:()=>fr,addConversionActionsIntoGoal:()=>xr,addGoals:()=>Mr,addScopeRules:()=>Lr,addSegmentationRulesIntoSegment:()=>Ur,addSegments:()=>Wr,closeAlternativePreviewer:()=>Dr,openAlternativePreviewer:()=>Or,removeAlternatives:()=>br,removeConversionActionsFromGoal:()=>yr,removeGoals:()=>Gr,removeScopeRules:()=>Vr,removeSegmentationRulesFromSegment:()=>Fr,removeSegments:()=>Hr,replaceAlternatives:()=>Er,replaceConversionActionsInGoal:()=>hr,replaceSegmentationRulesInSegment:()=>jr,setActiveGoal:()=>wr,setActiveSegment:()=>Nr,setAlternative:()=>_r,setDraftStatusRationale:()=>Ir,setExperimentAsBeingSaved:()=>Tr,setExperimentAsRecentlySaved:()=>Rr,setExperimentData:()=>Cr,setHeatmapData:()=>kr,setTestedElementAsInvalid:()=>Pr,setupEditor:()=>Ar,updateConversionAction:()=>Sr,updateGoal:()=>Br,updateSegment:()=>Yr,updateSegmentationRule:()=>qr});var i={};n.r(i),n.d(i,{moveToTrash:()=>ci,resumeExperiment:()=>mi,saveExperiment:()=>oi,saveExperimentAndEditAlternative:()=>si,saveExperimentAndPreviewAlternative:()=>li,startExperiment:()=>ui});var a={};n.r(a),n.d(a,{EditorProvider:()=>A,ExperimentName:()=>le,Header:()=>Z,STORE_NAME:()=>f,Sidebar:()=>en,initializeExperimentEditor:()=>Ei});const o=window.wp.element;window.wp.coreData;const s=window.wp.data,l=window.wp.domReady,c=n.n(l)(),u=window.lodash,m=window.nab.conversionActionLibrary,d=window.nab.data,p=window.nab.experimentLibrary,v=window.nab.segmentationRuleLibrary,g=window.nab.utils;var f="nab/editor",b={byId:{},allIds:[]},E={},_={id:0,type:"",status:"draft",name:"",description:"",startDate:"",endDate:"",endMode:"manual",endValue:0,isTestedElementInvalid:!1,links:{edit:"",preview:""}},x={},h={},y={},S={},A=function(e){var t=e.experiment,n=e.children,r=(0,o.useState)(!1),i=r[0],a=r[1],l=(0,s.useDispatch)(f),c=l.setupEditor,u=l.setActiveGoal,m=l.setActiveSegment;return(0,o.useEffect)((function(){if(t){var e=t.goals[0]||(0,g.createGoal)(),n=t.segments[0];c(t),u(e.id),n&&m(n.id),a(!0)}}),[!!t]),i?o.createElement("div",null,n):null};const w=window.wp.components,N=window.wp.i18n,T=window.wp.notices,I=window.nab.conversionActions,R=window.nab.date,O=window.nab.segmentationRules,D=window.wp.hooks;function C(e,t){return!!k(e.attributes,t)}function k(e,t){var n=!(e&&!(0,g.isEmpty)(e)&&(0,u.values)(e).filter((function(e){return"boolean"!=typeof e})).filter((function(e){return void 0!==e})).every((function(e){return!!e})))&&(0,N._x)("Test doesn’t specify the tested element","text","nelio-ab-testing");return(0,D.applyFilters)("nab.isTestedElementInvalid",n,e,t)}function P(e,t,n){var r;if(!e.conversionActions.length)return(0,N.sprintf)(/* translators: goal name */
(0,N._x)("%s doesn’t have any conversion actions","text","nelio-ab-testing"),M(e,t));for(var i=0;i<e.conversionActions.length;++i){var a=e.conversionActions[i];if(a){var o=n[a.type];if(!o)return(0,N.sprintf)(/* translators: goal name */
(0,N._x)("%s has one or more invalid conversion actions","text","nelio-ab-testing"),M(e,t));if(!(0,g.isEmpty)(null===(r=o.validate)||void 0===r?void 0:r.call(o,a.attributes))||!(0,g.isEmpty)((0,g.getConversionActionScopeError)(a.scope)))return(0,N.sprintf)(/* translators: goal name, as in “Goal 2” or “Default Goal” */
(0,N._x)("One or more conversion actions in %s are invalid","text","nelio-ab-testing"),M(e,t))}}return!1}function M(e,t){var n=(0,N.sprintf)(/* translators: goal id */
(0,N._x)("Goal %d","text","nelio-ab-testing"),t+1);return 0===t&&(n=(0,N._x)("Default Goal","text","nelio-ab-testing")),(0,u.trim)(e.attributes.name)&&(n=(0,N.sprintf)(/* translators: goal name */
(0,N._x)("Goal “%s”","text","nelio-ab-testing"),(0,u.trim)(e.attributes.name))),n}function G(e,t,n){var r;if(!e.segmentationRules.length)return(0,N.sprintf)(/* translators: segment name */
(0,N._x)("%s doesn’t have any segmentation rules","text","nelio-ab-testing"),B(e,t));for(var i=0;i<e.segmentationRules.length;++i){var a=e.segmentationRules[i];if(a){var o=n[a.type];if(!o)return(0,N.sprintf)(/* translators: segment name */
(0,N._x)("%s has one or more invalid segmentation rules","text","nelio-ab-testing"),B(e,t));if(!(0,g.isEmpty)(null===(r=o.validate)||void 0===r?void 0:r.call(o,a.attributes)))return(0,N.sprintf)(/* translators: segment name, as in Segment 2” */
(0,N._x)("One or more segmentation rules in %s are invalid","text","nelio-ab-testing"),B(e,t))}}return!1}function B(e,t){var n=(0,N.sprintf)(/* translators: segment id */
(0,N._x)("Segment %d","text","nelio-ab-testing"),t+1);return(0,u.trim)(e.attributes.name)&&(n=(0,N.sprintf)(/* translators: segment name */
(0,N._x)("Segment “%s”","text","nelio-ab-testing"),(0,u.trim)(e.attributes.name))),n}function L(e){var t=(0,s.useSelect)((function(t){return t(f).getExperimentAttribute(e)})),n=(0,s.useDispatch)(f).setExperimentData;return[t,function(t){var r;return n(((r={})[e]=t,r))}]}function V(e){return(0,s.useSelect)((function(t){return t(d.STORE_NAME).getPluginSetting(e)}))}var U=function(e){return(0,s.useSelect)((function(t){return t(d.STORE_NAME).isSubscribedTo(e)}))},j=function(){return j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},j.apply(this,arguments)},F=function(){return q(),W(),null},q=function(){var e=H(),t=L("startDate")[0]||"",n=L("status"),r=n[0],i=n[1],a=(0,s.useDispatch)(f).setDraftStatusRationale,l=function(e,t){r.includes("paused")&&(e="draft"===e?"paused_draft":"paused"),i(e),a(null!=t?t:"")};(0,o.useEffect)((function(){"running"!==r&&"trash"!==r&&(e?l("draft",e):"ready"!==r&&("scheduled"!==r||(0,R.isInTheFuture)(t)||l("ready"),"scheduled"!==r&&l("ready")))}),[e,t,r])},W=function(){var e=L("status")[0],t=Y(),n=L("type")[0],r=(0,u.find)(t,{id:"control"}),i=(0,s.useSelect)((function(e){return e(f).isTestedElementInvalid()})),a=(0,s.useDispatch)(f).setTestedElementAsInvalid;(0,o.useEffect)((function(){if("running"!==e){var t=!!r&&C(r,n);(0,u.isEqual)(i,t)||a(!!r&&C(r,n))}}),[r,n,i])},H=function(){var e=(0,o.useState)(""),t=e[0],n=e[1],r=L("name")[0]||"",i=L("type")[0],a=Y(),s=$(),l=X(),c=z(),m=J();return(0,o.useEffect)((function(){var e=(0,u.find)(a,{id:"control"}),t=function(e,t,n){var r=e.control,i=e.alternatives,a=e.goals,o=e.segments,s=e.name,l=e.type;if(!s)return(0,N._x)("Test is unnamed","text","nelio-ab-testing");if(i.length<2)return(0,N._x)("Test doesn’t have any variants","text","nelio-ab-testing");var c=k(r.attributes,l);if(c)return c;var u=i.slice(1).reduce((function(e,t,n){return e||function(e,t,n){return(0,D.applyFilters)("nab.isAlternativeInvalid",!1,e,function(e){return String.fromCharCode("B".charCodeAt(0)+e)}(t),n)}(t.attributes,n,l)}),!1);if(u)return u;var m=function(e,t){if(!e.length)return(0,N._x)("Test doesn’t have any goals","text","nelio-ab-testing");for(var n=0;n<e.length;++n){var r=e[n];if(r){var i=P(r,n,t);if(i)return i}}return!1}(a,t);if(m)return m;var d=function(e,t){for(var n=0;n<e.length;++n){var r=e[n];if(r){var i=G(r,n,t);if(i)return i}}return!1}(o,n);return d||!1}({name:r,control:e,alternatives:a,goals:s,segments:l,type:i},c,m);n(t||"")}),[r,i,JSON.stringify(a),JSON.stringify(s),JSON.stringify(l)]),t},Y=function(){return(0,s.useSelect)((function(e){return e(f).getAlternatives()}))},$=function(){return(0,s.useSelect)((function(e){var t=e(f),n=t.getGoals,r=t.getConversionActions;return(0,u.map)(n(),(function(e){return j(j({},e),{conversionActions:r(e.id)})}))}))},X=function(){return(0,s.useSelect)((function(e){var t=e(f),n=t.getSegments,r=t.getSegmentationRules;return(0,u.map)(n(),(function(e){return j(j({},e),{segmentationRules:r(e.id)})}))}))},z=function(){return(0,s.useSelect)((function(e){return(0,u.keyBy)(e(I.STORE_NAME).getConversionActionTypes()||[],"name")}))},J=function(){return(0,s.useSelect)((function(e){return(0,u.keyBy)(e(O.STORE_NAME).getSegmentationRuleTypes()||[],"name")}))};const Q=window.nab.components,K=window.nab.experiments;var Z=function(){var e=(0,o.useRef)(null),t=ne(),n=te(),r=re(),i=L("status")[0],a=(i||"").includes("draft"),l=(i||"").includes("paused"),c=ie(),u=ae(),m=oe(),d=(0,s.useDispatch)(f),p=d.saveExperiment,v=d.setExperimentData,g=ee();return o.createElement("div",{ref:e,className:"nab-edit-experiment-header"},o.createElement("div",{className:"nab-edit-experiment-header__info"},t&&o.createElement(t,{className:"nab-edit-experiment-header__experiment-icon"}),o.createElement("h1",{className:"nab-edit-experiment-header__title"},(0,N._x)("Edit Test","text","nelio-ab-testing")),o.createElement(Q.SubscribeWithCouponButton,{className:"finished"===i?"nab-edit-experiment-header__right-promo-button":void 0})),o.createElement("div",{className:"nab-edit-experiment-header__settings"},c&&o.createElement("span",{className:"nab-edit-experiment-header__save-button nab-edit-experiment-header__save-button--is-saving"},o.createElement(w.Dashicon,{icon:"cloud"}),(0,N._x)("Saving…","text","nelio-ab-testing")),u&&"scheduled"!==i&&o.createElement("span",{className:"nab-edit-experiment-header__save-button nab-edit-experiment-header__save-button--has-been-saved"},o.createElement(w.Dashicon,{icon:"yes"}),(0,N._x)("Saved","text (experiment)","nelio-ab-testing")),!c&&!(u&&"scheduled"!==i)&&o.createElement(w.Button,{variant:"tertiary",className:"nab-edit-experiment-header__save-button",onClick:"scheduled"===i?function(){v({status:l?"paused":"ready"}),p()}:p},"scheduled"===i?(0,N._x)("Save as Ready","command (experiment)","nelio-ab-testing"):(0,N._x)("Save","command","nelio-ab-testing")),o.createElement("div",{className:"nab-edit-experiment-header__start-button"},o.createElement(Q.Tooltip,{text:r,placement:"left",getTooltipContainer:e.current?function(){return e.current}:void 0},o.createElement("span",null,o.createElement(w.Button,{variant:"primary",disabled:a||c||!g||u&&"scheduled"===i,onClick:m},n))))))},ee=function(){var e=(L("status")[0]||"").includes("paused");return(0,s.useSelect)((function(t){return(0,t(d.STORE_NAME).hasCapability)(e?"resume_nab_experiments":"start_nab_experiments")}))},te=function(){var e=L("startDate")[0],t=L("status")[0];return(t||"").includes("paused")?(0,N._x)("Resume…","command","nelio-ab-testing"):e&&(0,R.isInTheFuture)(e)?"scheduled"===t?(0,N._x)("Schedule","command","nelio-ab-testing"):(0,N._x)("Schedule…","command","nelio-ab-testing"):(0,N._x)("Start…","command","nelio-ab-testing")},ne=function(){return(0,s.useSelect)((function(e){var t,n=e(K.STORE_NAME).getExperimentTypes,r=e(f).getExperimentType;return null===(t=n()[r()])||void 0===t?void 0:t.icon}))},re=function(){return(0,s.useSelect)((function(e){return e(f).getDraftStatusRationale()}))},ie=function(){return(0,s.useSelect)((function(e){return e(f).isExperimentBeingSaved()}))},ae=function(){return(0,s.useSelect)((function(e){return e(f).hasExperimentBeenRecentlySaved()}))},oe=function(){var e=L("status")[0],t=L("startDate")[0],n=(e||"").includes("paused"),r=(0,s.useDispatch)(f),i=r.resumeExperiment,a=r.setExperimentData,o=r.saveExperiment,l=r.startExperiment;return function(){n?i():t&&(0,R.isInTheFuture)(t)?(a({status:"scheduled"}),o()):l()}};const se=window.wp.blockEditor;var le=function(){var e=L("name"),t=e[0],n=e[1];return o.createElement("div",{className:"nab-experiment-title"},o.createElement(se.PlainText,{value:t,className:"nab-experiment-title__edit",placeholder:(0,N._x)("Name your test…","user","nelio-ab-testing"),onChange:n}))};const ce=window.React;function ue(e){return e.startsWith("{{/")?{type:"componentClose",value:e.replace(/\W/g,"")}:e.endsWith("/}}")?{type:"componentSelfClosing",value:e.replace(/\W/g,"")}:e.startsWith("{{")?{type:"componentOpen",value:e.replace(/\W/g,"")}:{type:"string",value:e}}function me(e,t){let n,r,i=[];for(let a=0;a<e.length;a++){const o=e[a];if("string"!==o.type){if(void 0===t[o.value])throw new Error(`Invalid interpolation, missing component node: \`${o.value}\``);if("object"!=typeof t[o.value])throw new Error(`Invalid interpolation, component node must be a ReactElement or null: \`${o.value}\``);if("componentClose"===o.type)throw new Error(`Missing opening component token: \`${o.value}\``);if("componentOpen"===o.type){n=t[o.value],r=a;break}i.push(t[o.value])}else i.push(o.value)}if(n){const a=function(e,t){const n=t[e];let r=0;for(let i=e+1;i<t.length;i++){const e=t[i];if(e.value===n.value){if("componentOpen"===e.type){r++;continue}if("componentClose"===e.type){if(0===r)return i;r--}}}throw new Error("Missing closing component token `"+n.value+"`")}(r,e),o=me(e.slice(r+1,a),t),s=(0,ce.cloneElement)(n,{},o);if(i.push(s),a<e.length-1){const n=me(e.slice(a+1),t);i=i.concat(n)}}return i=i.filter(Boolean),0===i.length?null:1===i.length?i[0]:(0,ce.createElement)(ce.Fragment,null,...i)}function de(e){const{mixedString:t,components:n,throwErrors:r}=e;if(!n)return t;if("object"!=typeof n){if(r)throw new Error(`Interpolation Error: unable to process \`${t}\` because components is not an object`);return t}const i=function(e){return e.split(/(\{\{\/?\s*\w+\s*\/?\}\})/g).map(ue)}(t);try{return me(i,n)}catch(e){if(r)throw new Error(`Interpolation Error: unable to process \`${t}\` because of error \`${e.message}\``);return t}}var pe=function(){return pe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pe.apply(this,arguments)},ve=function(e){var t,n=e.readOnly,r=e.action,i=e.goalId,a=ge(),s=fe(),l=be(),c=Ee(r.type),u=null==c?void 0:c.view,m=null==c?void 0:c.edit,d=null==c?void 0:c.icon,p=(null==r?void 0:r.attributes)||{},v=(null==r?void 0:r.scope)||{type:"test-scope"},f=null!==(t=null==c?void 0:c.validate)&&void 0!==t?t:function(){return{}},b=pe(pe({},f(p)),{_scope:(0,g.getConversionActionScopeError)(v)}),E=(0,o.useState)(!(0,g.isEmpty)(b))[0],_=_e(i,r.id),x=_.setAttributes,h=_.setScope,y=xe(i,r.id);return s?n?o.createElement("div",{className:"nab-conversion-action"},o.createElement("div",{className:"nab-conversion-action__view"},d?o.createElement(d,{className:"nab-conversion-action__icon"}):o.createElement(w.Dashicon,{className:"nab-conversion-action__icon nab-conversion-action__icon--invalid",icon:"warning"}),o.createElement("div",{className:"nab-conversion-action__actual-view"},u?o.createElement(u,{attributes:p,scope:v,experimentId:a,goal:s.attributes,goalId:i,goalIndex:l}):o.createElement("span",null,(0,N._x)("Invalid conversion action.","text","nelio-ab-testing"))))):o.createElement(w.PanelBody,{className:"nab-conversion-action",initialOpen:E,title:o.createElement("div",{className:"nab-conversion-action__view"},d?o.createElement(d,{className:"nab-conversion-action__icon"}):o.createElement(w.Dashicon,{className:"nab-conversion-action__icon nab-conversion-action__icon--invalid",icon:"warning"}),o.createElement("div",{className:"nab-conversion-action__actual-view"},u?o.createElement(u,{attributes:p,scope:v,experimentId:a,goal:s.attributes,goalId:i,goalIndex:l}):o.createElement("span",null,(0,N._x)("Invalid conversion action.","text","nelio-ab-testing"))))},o.createElement("div",{className:"nab-conversion-action__edit"},m?o.createElement(m,{attributes:p,scope:v,experimentId:a,goal:s.attributes,goalId:i,goalIndex:l,setAttributes:x,setScope:h,errors:b}):o.createElement("span",null,(0,N._x)("This conversion action can’t be properly loaded. Please consider removing it.","text","nelio-ab-testing"))),o.createElement(w.Button,{variant:"link",isDestructive:!0,onClick:y,className:"nab-conversion-action__delete-button"},(0,N._x)("Delete","command","neli-ab-testing"))):null},ge=function(){return(0,s.useSelect)((function(e){return e(f).getExperimentId()}))},fe=function(){return(0,s.useSelect)((function(e){return e(f).getActiveGoal()}))},be=function(){return(0,s.useSelect)((function(e){return e(f).getActiveGoalIndex()}))},Ee=function(e){return(0,s.useSelect)((function(t){return t(I.STORE_NAME).getConversionActionType(e)}))},_e=function(e,t){var n=(0,s.useDispatch)(f).updateConversionAction,r=function(r,i){return n(e,t,r,i)},i=(0,o.useCallback)((function(e){return r(e,void 0)}),[e,t]),a=(0,o.useCallback)((function(e){return r(void 0,e)}),[e,t]);return{setAttributes:e&&t?i:u.noop,setScope:e&&t?a:u.noop}},xe=function(e,t){var n=(0,s.useDispatch)(f).removeConversionActionsFromGoal;return e&&t?function(){return n(e,t)}:u.noop},he=function(){var e=ye(),t=Se(e);return o.createElement("div",{className:"nab-conversion-action-list nab-conversion-action-list--automatic"},1===t.length?o.createElement("p",{key:"conversion-action-explanation",className:"nab-conversion-action-list__help"},(0,N._x)("By default, there will be a new conversion in this test when the following conversion action occurs after the visitor has seen the tested element:","text","nelio-ab-testing")):o.createElement("p",{key:"conversion-action-explanation",className:"nab-conversion-action-list__help"},(0,N._x)("Split tests are usually run with some specific goals in mind. In this type of test, there’s a new conversion when at least one of the following conversion actions occurs after the visitor has seen the tested element:","text","nelio-ab-testing")),e&&t.map((function(t){return o.createElement(ve,{key:t.id,goalId:e,action:t,readOnly:!0})})))},ye=function(){return(0,s.useSelect)((function(e){var t;return null===(t=e(f).getActiveGoal())||void 0===t?void 0:t.id}))},Se=function(e){return(0,s.useSelect)((function(t){return e&&(0,t(f).getConversionActions)(e)||[]}))},Ae=function(){var e=we(),t=Ne(e);return o.createElement("div",{className:"nab-conversion-action-list"},!!t.length&&o.createElement("p",{key:"conversion-action-explanation-1"},(0,N._x)("After a visitor has seen the tested element, there’s a new conversion every time one of the following conversion actions occurs:","text","nelio-ab-testing")),e&&t.map((function(t){return o.createElement(ve,{key:t.id,goalId:e,action:t})})),!t.length&&[o.createElement("p",{key:"conversion-action-explanation-1",className:"nab-conversion-action-list__help"},(0,N._x)("Split tests are usually run with some specific goals in mind, such as “getting more subscribers” or “showing interest in your products.” Goals are fulfilled when the visitor performs certain actions. For instance, a visitor might be “showing interest in your products” when they visit your pricing page or they submit a certain form in your website.","text","nelio-ab-testing")),o.createElement("p",{key:"conversion-action-explanation-2",className:"nab-conversion-action-list__help"},de({mixedString:(0,N._x)("Use the buttons below to {{strong}}add the specific conversion actions{{/strong}} that fulfill this goal.","user","nelio-ab-testing"),components:{strong:o.createElement("strong",null)}}))])},we=function(){return(0,s.useSelect)((function(e){var t;return null===(t=e(f).getActiveGoal())||void 0===t?void 0:t.id}))},Ne=function(e){return(0,s.useSelect)((function(t){return e&&(0,t(f).getConversionActions)(e)||[]}))},Te=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Ie=function(){var e=!!V("subscription"),t=Re(),n=!!De(t).length,r=Oe(),i=(0,s.useDispatch)(f).addConversionActionsIntoGoal;return!e&&n?o.createElement("div",{className:"nab-conversion-action-type-list"},o.createElement(w.ExternalLink,{className:"components-button is-secondary",href:(0,g.addFreeTracker)((0,N._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,N._x)("Subscribe to Track More Actions","user","nelio-ab-testing"))):o.createElement("ul",{className:"nab-conversion-action-type-list"},r&&r.map((function(e){var n=e.icon;return o.createElement(w.Tooltip,{key:e.name,text:e.title,position:"top center"},o.createElement("li",{key:e.name,className:"nab-conversion-action-type-list__item"},o.createElement(w.Button,{variant:"secondary",className:"nab-conversion-action-type-list__new-action-button",onClick:function(){return function(e){if(t){var n=(0,I.createConversionAction)(e);n&&i(t,n)}}(e.name)}},o.createElement(n,null))))})))},Re=function(){return(0,s.useSelect)((function(e){var t;return null===(t=e(f).getActiveGoal())||void 0===t?void 0:t.id}))},Oe=function(){var e=Re(),t=De(e);return(0,s.useSelect)((function(e){var n=e(I.STORE_NAME).getConversionActionTypes,r=(0,u.filter)(n(),(function(t){return!t.isActive||t.isActive(e)})),i=(0,u.find)(r,{name:"nab/wc-order"});if(i&&t.length&&(0,u.every)(t,{type:"nab/wc-order"}))return[i];var a=(0,u.find)(r,{name:"nab/edd-order"});return a&&t.length&&(0,u.every)(t,{type:"nab/edd-order"})?[a]:(a||i)&&t.length?u.without.apply(void 0,Te([r],Te(Te([],i?[i]:[],!0),a?[a]:[],!0),!1)):r}))},De=function(e){return(0,s.useSelect)((function(t){return e&&t(f).getConversionActions(e)||[]}))},Ce=function(){var e=Me();return e?o.createElement(ke,{plugin:e}):null},ke=function(e){var t=e.plugin,n=Pe(t),r=Ge(),i=r[0],a=r[1],s=Le(t),l=Be(t),c=l[0],u=l[1];return o.createElement("div",{className:"nab-ecommerce-goal-settings"},o.createElement("p",null,o.createElement("strong",null,n)),o.createElement(w.SelectControl,{label:(0,N._x)("Order status required for conversions:","command","nelio-ab-testing"),options:s,value:c,onChange:u}),o.createElement(w.CheckboxControl,{label:(0,N._x)("Track revenue and show in test results","command","nelio-ab-testing"),checked:i,onChange:a}))},Pe=function(e){switch(e){case"woocommerce":return(0,N._x)("WooCommerce Goal Settings","text","nelio-ab-testing");case"edd":return(0,N._x)("Easy Digital Downloads Goal Settings","text","nelio-ab-testing")}},Me=function(){return(0,s.useSelect)((function(e){var t,n=e(f).getActiveGoal,r=e(f).getConversionActions,i=null===(t=n())||void 0===t?void 0:t.id,a=i?r(i):[];if(a.length)return a.every((function(e){return"nab/wc-order"===e.type}))?"woocommerce":a.every((function(e){return"nab/edd-order"===e.type}))?"edd":void 0}))},Ge=function(){var e,t=Ve(),n=null===(e=null==t?void 0:t.attributes.useOrderRevenue)||void 0===e||e,r=(0,s.useDispatch)(f).updateGoal;return[n,function(){return t?r(t.id,{useOrderRevenue:!n}):void 0}]},Be=function(e){var t=Ve(),n=Le(e),r=null==t?void 0:t.attributes.orderStatusForConversion,i=r&&n.map((function(e){return e.value})).includes(null==t?void 0:t.attributes.orderStatusForConversion)?r:Ue(e),a=(0,s.useDispatch)(f).updateGoal;return[i,function(e){return t?a(t.id,{orderStatusForConversion:e}):void 0}]},Le=function(e){return(0,s.useSelect)((function(t){return t(d.STORE_NAME).getECommerceSetting(e,"orderStatuses")}))},Ve=function(){return(0,s.useSelect)((function(e){return e(f).getActiveGoal()}))},Ue=function(e){switch(e){case"woocommerce":return"wc-completed";case"edd":return"complete"}},je=function(e){var t=e.name,n=e.setName,r=e.removeGoal,i=e.isAutomatic;return o.createElement("div",{className:"nab-current-goal-info"},!i&&o.createElement("div",{className:"nab-current-goal-info__header"},o.createElement(w.TextControl,{placeholder:(0,N._x)("Name your goal…","user","nelio-ab-testing"),value:t,onChange:function(e){return n(e)}}),!!r&&o.createElement(w.Button,{variant:"tertiary",isDestructive:!0,className:"nab-current-goal-info__delete-button",onClick:r},(0,N._x)("Delete","command (goal)","nelio-ab-testing"))),o.createElement(Ce,null),i?o.createElement(he,null):o.createElement(o.Fragment,null,o.createElement(Ae,null),o.createElement(Ie,null)))},Fe=n(4184),qe=n.n(Fe),We=function(){var e=He(),t=Ye(),n=$e(),r=!!V("subscription"),i=(0,s.useDispatch)(f),a=i.setActiveGoal,l=i.addGoals;return o.createElement("ul",{className:"nab-goal-list"},t.map((function(t,n){return o.createElement("li",{key:t.id,className:qe()("nab-goal-list__item",{"nab-goal-list__item--is-active":t.id===e})},o.createElement(w.Button,{disabled:t.id===e,onClick:function(){return a(t.id)}},(0,u.trim)(t.attributes.name)||function(e){return e?(0,N.sprintf)(/* translators: a number */
(0,N._x)("Goal %d","text","nelio-ab-testing"),e+1):(0,N._x)("Default Goal","text","nelio-ab-testing")}(n)))})),!n&&r&&o.createElement("li",{className:"nab-goal-list__add-new-goal",key:"add-new-goal"},o.createElement(w.Button,{className:"nab-goal-list__add-new-goal-button",variant:"link",onClick:function(){var e=(0,g.createGoal)();l(e),a(e.id)}},o.createElement(w.Dashicon,{icon:"plus"}),o.createElement("span",null,(0,N._x)("New","command (goal)","nelio-ab-testing")))))},He=function(){return(0,s.useSelect)((function(e){var t;return null===(t=e(f).getActiveGoal())||void 0===t?void 0:t.id}))},Ye=function(){return(0,s.useSelect)((function(e){return e(f).getGoals()}))},$e=function(){return(L("status")[0]||"").includes("paused")},Xe=function(){return Xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xe.apply(this,arguments)},ze=function(){var e;et();var t=Je(),n=Qe(),r=Ke(),i=n.length,a=Ze(),l=(0,s.useDispatch)(f),c=l.removeGoals,m=l.setActiveGoal,d=l.updateGoal,p=1<i&&!r;return o.createElement("div",{className:"nab-edit-experiment__goal-section"},o.createElement("h2",null,de({mixedString:(0,N.sprintf)(/* translators: dashicon */
(0,N._x)("%s Conversion Goals and Actions","text","nelio-ab-testing"),"{{icon}}{{/icon}}"),components:{icon:o.createElement(w.Dashicon,{className:"nab-goal-section__title-icon",icon:"flag"})}})),o.createElement("div",{className:"nab-edit-experiment-goal-section__content"},o.createElement(We,null),o.createElement(je,{name:null!==(e=null==t?void 0:t.attributes.name)&&void 0!==e?e:"",setName:function(e){return n={name:e},t&&d(t.id,Xe(Xe({},t.attributes),n));var n},removeGoal:p?function(){if(t){var e=function(e,t){var n=(0,u.findIndex)(e,{id:t});return n===e.length-1?e[n-1]:e[n+1]}(n,t.id);e&&(m(e.id),c(t.id))}}:void 0,isAutomatic:a})))},Je=function(){return(0,s.useSelect)((function(e){return e(f).getActiveGoal()}))},Qe=function(){return(0,s.useSelect)((function(e){return e(f).getGoals()}))},Ke=function(){return(L("status")[0]||"").includes("paused")},Ze=function(){var e=Je(),t=Qe();return(0,s.useSelect)((function(n){var r,i=n(f).getExperimentType,a=n(K.STORE_NAME).hasExperimentSupport;return(null==e?void 0:e.id)===(null===(r=t[0])||void 0===r?void 0:r.id)&&a(i(),"automaticGoalSetup")}))},et=function(){var e,t=(0,s.useDispatch)(f).replaceConversionActionsInGoal,n=null===(e=Qe()[0])||void 0===e?void 0:e.id,r=(0,s.useSelect)((function(e){return e(f).getAlternative("control")})),i=(0,s.useSelect)((function(e){var t=e(f).getExperimentType;return(0,e(K.STORE_NAME).getExperimentSupport)(t(),"automaticGoalSetup")})),a=(0,s.useSelect)((function(e){return e(f),n?e(f).getConversionActions(n):[]}));(0,o.useEffect)((function(){if(r&&n&&i){var e=i(r.attributes);(0,u.isEqual)(tt(a),tt(e))||t(n,e)}}),[i,n,r])},tt=function(e){return e.map((function(e){return(0,u.omit)(e,"id")}))},nt=function(e){var t,n=e.readOnly,r=e.rule,i=e.segmentId,a=rt(),s=it(),l=at(r.type),c=null==l?void 0:l.view,u=null==l?void 0:l.edit,m=null==l?void 0:l.icon,d=(null==r?void 0:r.attributes)||{},p=(null!==(t=null==l?void 0:l.validate)&&void 0!==t?t:function(){return{}})(d),v=(0,o.useState)(!(0,g.isEmpty)(p))[0],f=ot(i,r.id),b=st(i,r.id);return n?o.createElement("div",{className:"nab-segmentation-rule"},o.createElement("div",{className:"nab-segmentation-rule__view"},m?o.createElement(m,{className:"nab-segmentation-rule__icon"}):o.createElement(w.Dashicon,{className:"nab-segmentation-rule__icon nab-segmentation-rule__icon--invalid",icon:"warning"}),o.createElement("div",{className:"nab-segmentation-rule__actual-view"},c?o.createElement(c,{attributes:d,experimentId:a,segmentId:i,segmentIndex:s}):o.createElement("span",null,(0,N._x)("Invalid segmentation rule.","text","nelio-ab-testing"))))):o.createElement(w.PanelBody,{className:"nab-segmentation-rule",initialOpen:v,title:o.createElement("div",{className:"nab-segmentation-rule__view"},m?o.createElement(m,{className:"nab-segmentation-rule__icon"}):o.createElement(w.Dashicon,{className:"nab-segmentation-rule__icon nab-segmentation-rule__icon--invalid",icon:"warning"}),o.createElement("div",{className:"nab-segmentation-rule__actual-view"},c?o.createElement(c,{attributes:d,experimentId:a,segmentId:i,segmentIndex:s}):o.createElement("span",null,(0,N._x)("Invalid segmentation rule.","text","nelio-ab-testing"))))},o.createElement("div",{className:"nab-segmentation-rule__edit"},u?o.createElement(u,{attributes:d,experimentId:a,segmentId:i,segmentIndex:s,setAttributes:f,errors:p}):o.createElement("span",null,(0,N._x)("This segmentation rule can’t be properly loaded. Please consider removing it.","text","nelio-ab-testing"))),o.createElement(w.Button,{variant:"link",isDestructive:!0,onClick:b,className:"nab-segmentation-rule__delete-button"},(0,N._x)("Delete","command","neli-ab-testing")))},rt=function(){return(0,s.useSelect)((function(e){return e(f).getExperimentId()}))},it=function(){return(0,s.useSelect)((function(e){return e(f).getActiveSegmentIndex()}))},at=function(e){return(0,s.useSelect)((function(t){return t(O.STORE_NAME).getSegmentationRuleType(e)}))},ot=function(e,t){var n=(0,s.useDispatch)(f).updateSegmentationRule;return e&&t?function(r){return n(e,t,r)}:u.noop},st=function(e,t){var n=(0,s.useDispatch)(f).removeSegmentationRulesFromSegment;return e&&t?function(){return n(e,t)}:u.noop},lt=function(){var e=ct(),t=ut();return e?o.createElement("div",{className:"nab-segmentation-rule-list"},!!t.length&&o.createElement("p",{key:"segmentation-rule-explanation-1"},(0,N._x)("A visitor participates in the test every time all of the following segmentation rules match:","text","nelio-ab-testing")),t.map((function(t){return o.createElement(nt,{key:t.id,segmentId:e,rule:t})})),!t.length&&[o.createElement("p",{key:"segmentation-rule-explanation-1",className:"nab-segmentation-rule-list__help"},(0,N._x)("Split tests are usually applied to all visitors. But you can narrow your audience using segmentation rules to target only a subset of your visitors.","text","nelio-ab-testing")),o.createElement("p",{key:"segmentation-rule-explanation-2",className:"nab-segmentation-rule-list__help"},de({mixedString:(0,N._x)("Use the buttons below to {{strong}}add the specific segmentation rules{{/strong}} for this segment.","user","nelio-ab-testing"),components:{strong:o.createElement("strong",null)}}))]):null},ct=function(){return(0,s.useSelect)((function(e){var t;return null===(t=e(f).getActiveSegment())||void 0===t?void 0:t.id}))},ut=function(){var e=ct();return(0,s.useSelect)((function(t){return e&&(0,t(f).getSegmentationRules)(e)||[]}))},mt=function(e){var t=e.category,n=dt(t.name),r=pt(),i=gt(),a=t.icon;return n.length?o.createElement("li",{key:t.name,className:"nab-segmentation-rule-type-category"},o.createElement(w.DropdownMenu,{icon:o.createElement(a,null),className:"nab-segmentation-rule-type-category__item",label:t.title,controls:n.map((function(e){var t=e.name,n=e.title,a=e.icon;return{title:n,icon:o.createElement(a,null),isDisabled:r.some((function(e){return e.type===t})),onClick:function(){return i(t)}}})),toggleProps:{className:"nab-segmentation-rule-type-category__toggle",disabled:n.every((function(e){return r.some((function(t){return t.type===e.name}))}))},menuProps:{className:"nab-segmentation-rule-type-category__menu"}})):null},dt=function(e){return(0,s.useSelect)((function(t){return(t(O.STORE_NAME).getSegmentationRuleTypes()||[]).filter((function(t){return t.category===e}))}))},pt=function(){var e=vt();return(0,s.useSelect)((function(t){var n=t(f).getSegmentationRules;return(null==e?void 0:e.id)&&n(e.id)||[]}))},vt=function(){return(0,s.useSelect)((function(e){return e(f).getActiveSegment()}))},gt=function(){var e=(0,s.useDispatch)(f).addSegmentationRulesIntoSegment,t=vt();return function(n){if(t){var r=(0,O.createSegmentationRule)(n);r&&e(t.id,r)}}},ft=function(){var e=bt();return V("subscription")?o.createElement("ul",{className:"nab-segmentation-rule-type-category-list"},e.map((function(e){return o.createElement(mt,{key:e.name,category:e})}))):o.createElement("div",{className:"nab-segmentation-rule-type-list"},o.createElement(w.ExternalLink,{className:"components-button is-secondary",href:(0,g.addFreeTracker)((0,N._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,N._x)("Subscribe to Use Segmentation Rules","user","nelio-ab-testing")))},bt=function(){return(0,s.useSelect)((function(e){return e(O.STORE_NAME).getSegmentationRuleTypeCategories()||[]}))},Et=function(e){var t=e.name,n=e.setName,r=e.removeSegment;return o.createElement("div",{className:"nab-current-segment-info"},o.createElement("div",{className:"nab-current-segment-info__header"},o.createElement(w.TextControl,{placeholder:(0,N._x)("Name your segment…","user","nelio-ab-testing"),value:t,onChange:function(e){return n(e)}}),!!r&&o.createElement(w.Button,{variant:"tertiary",isDestructive:!0,className:"nab-current-segment-info__delete-button",onClick:r},(0,N._x)("Delete","command (segment)","nelio-ab-testing"))),o.createElement(o.Fragment,null,o.createElement(lt,null),o.createElement(ft,null)))},_t=function(){var e=xt(),t=ht(),n=yt(),r=!!V("subscription"),i=(0,s.useDispatch)(f),a=i.setActiveSegment,l=i.addSegments;return o.createElement("ul",{className:"nab-segment-list"},t.map((function(t,n){return o.createElement("li",{key:t.id,className:qe()("nab-segment-list__item",{"nab-segment-list__item--is-active":t.id===e})},o.createElement(w.Button,{disabled:t.id===e,onClick:function(){return a(t.id)}},(0,u.trim)(t.attributes.name)||St(n)))})),!n&&r&&o.createElement("li",{className:"nab-segment-list__add-new-segment",key:"add-new-segment"},o.createElement(w.Button,{className:"nab-segment-list__add-new-segment-button",variant:"link",onClick:function(){var e=(0,g.createSegment)();l(e),a(e.id)}},o.createElement(w.Dashicon,{icon:"plus"}),o.createElement("span",null,(0,N._x)("New","command (segment)","nelio-ab-testing")))))},xt=function(){return(0,s.useSelect)((function(e){var t;return null===(t=e(f).getActiveSegment())||void 0===t?void 0:t.id}))},ht=function(){return(0,s.useSelect)((function(e){return e(f).getSegments()||[]}))},yt=function(){return L("status")[0].includes("paused")},St=function(e){return(0,N.sprintf)(/* translators: a number */
(0,N._x)("Segment %d","text","nelio-ab-testing"),e+1)},At=function(){return At=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},At.apply(this,arguments)},wt=function(){var e=Nt(),t=e[0],n=e[1],r=L("status")[0],i=!!V("subscription"),a=(r||"").includes("paused"),s=Tt(),l=!a;return o.createElement("div",{className:"nab-edit-experiment__segmentation-section"},o.createElement("h2",null,de({mixedString:(0,N.sprintf)(/* translators: dashicon */
(0,N._x)("%s Segmentation","text","nelio-ab-testing"),"{{icon}}{{/icon}}"),components:{icon:o.createElement(w.Dashicon,{className:"nab-segmentation-section__title-icon",icon:"groups"})}})),!!i&&o.createElement("div",{className:"nab-edit-experiment-segmentation-section__content"},o.createElement(_t,null),t?o.createElement(Et,{name:t.attributes.name,setName:function(e){return n(At(At({},t.attributes),{name:e}))},removeSegment:l?s:void 0}):o.createElement("p",{className:"nab-edit-experiment-segmentation-section__content--empty"},(0,N._x)("Add a new segment to narrow your tested audience and target only a subset of your visitors.","user","nelio-ab-testing"))),!i&&o.createElement("div",{className:"nab-edit-experiment-segmentation-section__content nab-edit-experiment-segmentation-section__content--free"},o.createElement("p",null,(0,N._x)("All your visitors participate in this test. Segmentation allows you to narrow your tested audience and target only a subset of your visitors.","user","nelio-ab-testing")),o.createElement("div",{className:"nab-edit-experiment-segmentation-section__content-action"},o.createElement(w.ExternalLink,{className:"components-button is-secondary",href:(0,g.addFreeTracker)((0,N._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,N._x)("Subscribe to Unlock Segmentation","user","nelio-ab-testing")))))},Nt=function(){var e=(0,s.useSelect)((function(e){return e(f).getActiveSegment()})),t=(0,s.useDispatch)(f).updateSegment;return[e,function(n){(null==e?void 0:e.id)&&t(e.id,n)}]},Tt=function(){var e=Nt()[0],t=(0,s.useSelect)((function(e){return e(f).getSegments()})),n=(0,s.useDispatch)(f),r=n.removeSegments,i=n.setActiveSegment;return e?function(){var n=function(e,t){var n=(0,u.findIndex)(e,{id:t});return e[n+1]||e[n-1]||!1}(t,e.id);n&&i(n.id),r(e.id)}:function(){return null}},It=function(){var e=L("status")[0];return o.createElement(w.PanelRow,{className:"nab-experiment-management__status"},o.createElement("span",null,(0,N._x)("Status","text","nelio-ab-testing")),o.createElement("strong",{className:"nab-experiment-management__status-value"},function(e){switch(e){case"draft":return(0,N._x)("Draft","text (experiment status)","nelio-ab-testing");case"ready":return(0,N._x)("Ready","text (experiment status)","nelio-ab-testing");case"scheduled":return(0,N._x)("Scheduled","text (experiment status)","nelio-ab-testing");case"paused":return(0,N._x)("Paused","text (experiment status)","nelio-ab-testing");case"paused_draft":return(0,N._x)("Paused Draft","text (experiment status)","nelio-ab-testing");case"running":case"finished":case"trash":return"-"}}(e)))},Rt=function(){var e=L("startDate"),t=e[0],n=e[1],r=U("professional"),i=Ot();return o.createElement(w.PanelRow,{className:"nab-experiment-start-schedule"},o.createElement("span",null,(0,N._x)("Start","text","nelio-ab-testing")),o.createElement("span",null,!!i&&o.createElement("span",{className:"nab-experiment-start-schedule__date"},(0,R.formatI18nDatetime)(t)),!i&&!r&&o.createElement("span",{className:"nab-experiment-start-schedule__date"},(0,N._x)("Immediately","text","nelio-ab-testing")),!i&&!!r&&o.createElement(Q.DateTimePicker,{className:"nab-experiment-start-schedule__date",date:t,onChange:function(e){return n(e||"")},noDateLabel:(0,N._x)("Immediately","text","nelio-ab-testing"),readonly:!0})))},Ot=function(){return L("status")[0].includes("paused")};const Dt=window.wp.compose,Ct=window.nab.i18n;var kt,Pt=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Mt=function(){var e=(0,Dt.useInstanceId)(Mt),t=U("professional"),n=L("endMode")[0],r=L("endValue")[0],i=Gt(),a=Vt[n],l=Bt(),c=l[0],u=l[1],m=(0,s.useDispatch)(f).setExperimentData,d=function(e,t){return m({endMode:e,endValue:t})};return t?o.createElement(w.PanelRow,{className:"nab-experiment-end-schedule"},o.createElement("span",null,(0,N._x)("End","text","nelio-ab-testing")),o.createElement(w.Dropdown,{position:"bottom right",contentClassName:"nab-experiment-end-schedule__dropdown",renderToggle:function(t){var i=t.onToggle,a=t.isOpen;return o.createElement(o.Fragment,null,o.createElement("label",{className:"nab-experiment-end-schedule__value screen-reader-text",htmlFor:"nab-experiment-end-schedule__toggle-".concat(e)},(0,N._x)("Click to change","command","nelio-ab-testing")),o.createElement(w.Button,{variant:"link",id:"nab-experiment-end-schedule__toggle-".concat(e),type:"button",className:"nab-experiment-end-schedule__toggle",onClick:i,"aria-expanded":a,"aria-live":"polite"},function(e,t){switch(e){case"duration":return(0,N.sprintf)(/* translators: number of days */
(0,N._n)("After %d day","After %d days",t,"nelio-ab-testing"),t);case"page-views":return(0,N.sprintf)(/* translators: a number */
(0,N._n)("After %s page view","After %s page views",t,"nelio-ab-testing"),(0,Ct.numberFormat)(t));case"confidence":return(0,N.sprintf)(/* translators: a percentage number, such as “95” */
(0,N._x)("At %1$s%% confidence","text","nelio-ab-testing"),(0,Ct.numberFormat)(t));case"manual":return(0,N._x)("Manual","text","nelio-ab-testing")}}(n,r)))},renderContent:function(){return o.createElement(o.Fragment,null,o.createElement(w.SelectControl,{label:(0,N._x)("End Mode","text","nelio-ab-testing"),value:n,onChange:function(e){u(!1),d(e,function(e){switch(e){case"duration":return 15;case"page-views":return 5e3;case"confidence":return 97;case"manual":return 0}}(e))},options:Lt.filter((function(e){return"confidence"!==e.value||"nab/heatmap"!==i}))}),!!a&&o.createElement("div",{style:{marginTop:"1em"}},o.createElement(w.SelectControl,{label:(0,N._x)("Value","text","nelio-ab-testing"),onChange:function(e){u("custom"===e),d(n,Number.parseInt(e)||0)},value:c?"custom":"".concat(r),options:a})),!!a&&c&&o.createElement("div",{style:{marginTop:"0.5em"}},o.createElement(w.TextControl,{type:"number",placeholder:Ut(n),value:r||"",onChange:function(e){return d(n,Number.parseInt(e)||0)}})))}})):o.createElement(w.PanelRow,{className:"nab-experiment-end-schedule"},o.createElement("span",null,(0,N._x)("End","text","nelio-ab-testing")),o.createElement("span",null,(0,N._x)("Manual","text","nelio-ab-testing")))},Gt=function(){return(0,s.useSelect)((function(e){return e(f).getExperimentType()}))},Bt=function(){var e=L("endMode")[0],t=L("endValue")[0],n=Vt[e],r=!!(0,u.find)(n,{value:"custom"})&&!(0,u.find)(n,{value:"".concat(t)}),i=(0,o.useState)(r);return[i[0],i[1]]},Lt=[{value:"manual",label:(0,N._x)("Manual","text","nelio-ab-testing")},{value:"duration",label:(0,N._x)("Duration","text","nelio-ab-testing")},{value:"page-views",label:(0,N._x)("Page Views","text","nelio-ab-testing")},{value:"confidence",label:(0,N._x)("Confidence","text","nelio-ab-testing")}],Vt={manual:[],confidence:[95,96,97,98,99].map((function(e){return{value:"".concat(e),label:(0,N.sprintf)(/* translators: a percentage number, such as “95” */
(0,N._x)("%1$s%%","text","nelio-ab-testing"),(0,Ct.numberFormat)(e))}})),duration:Pt(Pt([],[5,7,15,30,60,90].map((function(e){return{value:"".concat(e),label:(0,N.sprintf)(/* translators: number of days */
(0,N._n)("%d day","%d days",e,"nelio-ab-testing"),e)}})),!0),[{value:"custom",label:(0,N._x)("Custom","text","nelio-ab-testing"),placeholder:(0,N._x)("Days","text","nelio-ab-testing")}],!1),"page-views":Pt(Pt([],[2500,5e3,1e4,2e4,5e4,1e5].map((function(e){return{value:"".concat(e),label:(0,Ct.numberFormat)(e)}})),!0),[{value:"custom",label:(0,N._x)("Custom","text","nelio-ab-testing"),placeholder:(0,N._x)("Days","text","nelio-ab-testing")}],!1)},Ut=function(e){var t,n;return null!==(n=null===(t=(0,u.find)(Vt[e],{value:"custom"}))||void 0===t?void 0:t.placeholder)&&void 0!==n?n:""},jt=function(){var e=Ft(),t=(0,s.useDispatch)(f).moveToTrash;return o.createElement(w.PanelBody,{className:"nab-experiment-management",title:(0,N._x)("Status & Management","text (experiment)","nelio-ab-testing")},o.createElement(It,null),o.createElement(Rt,null),o.createElement(Mt,null),e&&o.createElement(w.PanelRow,{className:"nab-experiment-management__trash"},o.createElement(w.Button,{variant:"tertiary",isDestructive:!0,onClick:t},(0,N._x)("Move to Trash","command (experiment)","nelio-ab-testing"))))},Ft=function(){return(0,s.useSelect)((function(e){return e(d.STORE_NAME).hasCapability("delete_nab_experiments")}))},qt=function(){var e=L("description"),t=e[0],n=e[1];return o.createElement(w.PanelBody,{className:"nab-experiment-description",title:(0,N._x)("Description","text","nelio-ab-testing")},o.createElement(w.TextareaControl,{label:(0,N._x)("Describe your test (optional)","user","nelio-ab-testing"),className:"nab-experiment-description__textarea",value:t,onChange:n}))},Wt=function(e){var t=e.rules,n=e.scopeSupport,r=(0,o.useState)("partial"),i=r[0],a=r[1],l=(0,o.useState)(""),c=l[0],m=l[1],d=(0,s.useDispatch)(f).addScopeRules,p=c&&(0,g.isUrlFragmentInvalid)(c)||"";return o.createElement("div",{className:"nab-experiment-scope__new-rule-form"},o.createElement(w.SelectControl,{className:"nab-experiment-scope__new-rule-mode",label:(0,N._x)("Select URL matching mode","user","nelio-ab-testing"),value:i,options:Ht,onChange:function(e){return a(e)}}),o.createElement(w.TextControl,{className:"nab-experiment-scope__new-rule-value",label:(0,N._x)("Write a URL","user","nelio-ab-testing"),value:c,onChange:m}),o.createElement(Q.ErrorText,{value:p}),o.createElement(w.PanelRow,{className:"nab-experiment-scope__add-rule-action-container"},o.createElement(w.Button,{variant:"secondary",onClick:function(){m(""),"custom-with-tested-post"!==n||t.length?d([(0,g.createScopeRule)({type:i,value:c})]):d([(0,g.createScopeRule)({type:"tested-post"}),(0,g.createScopeRule)({type:i,value:c})])},disabled:(0,g.isEmpty)((0,u.trim)(c)),className:"nab-experiment-scope__add-rule-action"},(0,N._x)("Add","command","nelio-ab-testing"))))},Ht=[{value:"partial",label:(0,N._x)("URL contains the expected value","text","nelio-ab-testing")},{value:"exact",label:(0,N._x)("URL exactly matches the expected value","text","nelio-ab-testing")}],Yt=function(e){var t=e.rules,n=e.scopeSupport,r=(0,s.useDispatch)(f).removeScopeRules;return t.length?o.createElement(o.Fragment,null,o.createElement("p",null,"custom-with-tested-post"===n?(0,N._x)("Variants will be visible only on pages matching the following criteria, as well as on the tested element’s page.","text","nelio-ab-testing"):(0,N._x)("Variants will be visible only on pages matching the following criteria:","text","nelio-ab-testing")),o.createElement("ul",{className:"nab-experiment-scope__rule-list"},t.filter($t).map((function(e){var i=e.id,a=e.attributes,s=a.value,l=a.type;return o.createElement("li",{key:i,className:"nab-experiment-scope__rule-list-item"},o.createElement("span",{className:"nab-experiment-scope__active-rule-type"},"exact"===l&&(0,N._x)("URL is:","text","nelio-ab-testing"),"partial"===l&&(0,N._x)("URL contains:","text","nelio-ab-testing")),o.createElement("input",{type:"text",className:"nab-experiment-scope__active-rule-value",value:s,readOnly:!0}),o.createElement(w.Button,{variant:"link",isDestructive:!0,className:"nab-experiment-scope__remove-rule-action",onClick:function(){return function(e){"custom-with-tested-post"===n&&2===t.length?r((0,u.map)(t,"id")):r(e)}(i)}},(0,N._x)("Delete","command","nelio-ab-testing")))})))):o.createElement("p",null,"custom-with-tested-post"===n?(0,N._x)("Variants will be visible on all the pages of your website, including that of the tested element.","user","nelio-ab-testing"):(0,N._x)("Variants will be visible on all the pages of your website.","user","nelio-ab-testing")," ",(0,N._x)("If you wish to limit its scope to certain pages only, use the following form to define the URLs in which the test should run.","user","nelio-ab-testing"))},$t=function(e){return"exact"===e.attributes.type||"partial"===e.attributes.type},Xt=function(e){var t=e.rules,n=zt(t);return o.createElement(o.Fragment,null,t.length?o.createElement("p",null,(0,N._x)("Variants will be visible only on the tested element’s page.","text","nelio-ab-testing")):o.createElement("p",null,(0,N._x)("Variants will be visible on the tested element’s page. All other pages will also show the appropriate variant of this test whenever the tested element appears on them.","text","nelio-ab-testing")),o.createElement(w.CheckboxControl,{label:(0,N._x)("Global Consistency","command","nelio-ab-testing"),checked:!t.length,onChange:function(){return n(!t.length)}}))},zt=function(e){var t=(0,s.useDispatch)(f),n=t.addScopeRules,r=t.removeScopeRules;return function(t){r((0,u.map)(e,"id")),t&&n((0,g.createScopeRule)({type:"tested-post"}))}},Jt=function(){var e=Qt(),t=Kt(),n=Zt();return t?n?null:o.createElement(w.PanelBody,{className:"nab-experiment-scope",title:(0,N._x)("Test Scope","text","nelio-ab-testing")},"tested-post-with-consistency"===t?o.createElement(Xt,{rules:e}):o.createElement(o.Fragment,null,o.createElement(Yt,{rules:e,scopeSupport:t}),o.createElement(Wt,{rules:e,scopeSupport:t}))):null},Qt=function(){return(0,s.useSelect)((function(e){return e(f).getScope()}))},Kt=function(){return(0,s.useSelect)((function(e){return(0,e(K.STORE_NAME).getExperimentSupport)((0,e(f).getExperimentType)(),"scope")}))},Zt=function(){return(0,s.useSelect)((function(e){var t=e(f).getAlternative("control");return!!(null==t?void 0:t.attributes.testAgainstExistingContent)}))},en=function(){var e=tn();return o.createElement("div",{className:"nab-edit-experiment-sidebar",style:e},o.createElement("div",{className:"nab-edit-experiment-sidebar__element-wrapper"},o.createElement("h2",{className:"nab-edit-experiment-sidebar__section-title"},de({mixedString:(0,N.sprintf)(/* translators: dashicon */
(0,N._x)("%s Additional Settings","text","nelio-ab-testing"),"{{icon}}{{/icon}}"),components:{icon:o.createElement(w.Dashicon,{className:"nab-edit-experiment-sidebar__section-title-icon",icon:"admin-settings"})}})),o.createElement(jt,null),o.createElement(qt,null),o.createElement(Jt,null)))},tn=function(){return(0,s.useSelect)((function(e){var t=(0,e(d.STORE_NAME).getPageAttribute)("sidebarDimensions"),n=t.applyFix,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["applyFix"]);return n?r:void 0}))},nn=function(){return nn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},nn.apply(this,arguments)},rn=function(e){var t=e.alternativeId,n=e.disabled,r=e.index,i=on(t),a=cn(r),l=sn(),c=an(),u=un(r),m=ln(),d=mn(),p=!r,v=(0,s.useDispatch)(f),b=v.saveExperimentAndEditAlternative,E=v.saveExperimentAndPreviewAlternative,_=v.removeAlternatives,x=v.replaceAlternatives,h=v.setAlternative;return i?o.createElement("div",{className:qe()(["nab-alternative-list__alternative",{"nab-alternative-list__alternative--original":p}])},o.createElement("p",{className:qe()(["nab-alternative-list__alternative-letter",{"nab-alternative-list__alternative-letter--disabled":0<r&&n}])},(0,g.getLetter)(r)),o.createElement("div",{className:"nab-alternative-list__alternative-edit"},o.createElement(a,{attributes:i.attributes,disabled:n,experimentType:c,setAttributes:function(e){return h(i.id,nn(nn({},i),{attributes:(0,g.omitUndefineds)(nn(nn({},i.attributes),e))}))}}),0!==r&&o.createElement("ul",{className:"nab-alternative-list__alternative-actions"},d&&o.createElement("li",null,o.createElement(w.Button,{variant:"link",disabled:n||m,onClick:function(){return b(t)}},(0,N._x)("Edit","command","nelio-ab-testing"))),o.createElement("li",null,o.createElement(w.Button,{variant:"link",disabled:n||m,onClick:function(){return E(t)}},(0,N._x)("Preview","command","nelio-ab-testing"))),o.createElement("li",null,o.createElement(w.Button,{variant:"link",disabled:n||m,onClick:function(){return x(t,(0,g.createAlternative)())}},(0,N._x)("Reset","command","nelio-ab-testing"))),l&&o.createElement("li",null,o.createElement(w.Button,{variant:"link",isDestructive:!0,disabled:n||m,onClick:function(){return _(i.id)}},(0,N._x)("Delete","command","nelio-ab-testing"))))),o.createElement("div",{className:"nab-alternative-list__alternative-help"},!!u&&o.createElement(Q.HelpIcon,{text:u}))):null},an=function(){return(0,s.useSelect)((function(e){return e(f).getExperimentType()}))},on=function(e){var t,n=(0,o.useState)(!1),r=n[0],i=n[1],a=(t=an(),(0,s.useSelect)((function(e){var n;return null===(n=e(K.STORE_NAME).getExperimentType(t))||void 0===n?void 0:n.defaults}))),l=(0,s.useDispatch)(f).setAlternative,c=(0,s.useSelect)((function(t){return t(f).getAlternative(e)}));return(0,o.useEffect)((function(){if(!r&&a&&c){var t="control"===e?a.original:a.alternative;l(c.id,nn(nn({},c),{attributes:nn(nn({},t),c.attributes)})),i(!0)}}),[r,!!a,!!c]),r?c:void 0},sn=function(){var e=L("status")[0];return(0,s.useSelect)((function(t){var n=t(f).getAlternativeIds,r=(e||"").includes("paused");return n().length>2&&!r}))},ln=function(){return(0,s.useSelect)((function(e){return e(f).isExperimentBeingSaved()}))},cn=function(e){return(0,s.useSelect)((function(t){var n=(0,t(K.STORE_NAME).getExperimentView)((0,t(f).getExperimentType)(),e?"alternative":"original");return null!=n?n:function(){return o.createElement(o.Fragment,null)}}))},un=function(e){return(0,s.useSelect)((function(t){var n=t(f).getExperimentType,r=t(K.STORE_NAME).getHelpString;return 0===e?r(n(),"original"):1===e?r(n(),"alternative"):""}))},mn=function(){var e=an();return(0,s.useSelect)((function(t){return"external"===(0,t(K.STORE_NAME).getExperimentSupport)(e,"alternativeEdition")}))},dn=function(){var e=(0,s.useDispatch)(f).closeAlternativePreviewer,t=(0,s.useSelect)((function(e){return e(f).getAlternativePreviewerUrl()}));return t?o.createElement(w.Modal,{className:"nab-alternative-previewer",title:"Alternative Previewer",isDismissable:!0,isDismissible:!0,onRequestClose:e,shouldCloseOnClickOutside:!1},o.createElement("iframe",{className:"nab-alternative-previewer__iframe",title:(0,N._x)("Alternative Preview Frame","text","nelio-ab-testing"),src:t})):null},pn=function(){var e=vn(),t=e[0],n=e.slice(1),r=gn(),i=fn(),a=bn(),s=En(),l=xn();return o.createElement("div",{className:"nab-edit-experiment__alternative-section"},o.createElement("h2",null,de({mixedString:(0,N.sprintf)(/* translators: dashicon */
(0,N._x)("%s Control Version and Variants","text","nelio-ab-testing"),"{{icon}}{{/icon}}"),components:{icon:o.createElement(w.Dashicon,{className:"nab-alternative-section__title-icon",icon:"randomize"})}})),o.createElement("div",{className:"nab-alternative-list"},!!t&&o.createElement(rn,{key:"control",index:0,alternativeId:"control",disabled:s}),o.createElement(Q.AnimatedList,{disableAnimations:l,exit:500},n.map((function(e,t){return o.createElement(rn,{key:e,index:t+1,alternativeId:e,disabled:s})})))),o.createElement("div",{className:"nab-edit-experiment-alternative-section__new-variant-container"},!i&&!!a&&o.createElement(w.Button,{variant:"secondary",key:"new-variant",disabled:8<=n.length||s,onClick:function(){return r()}},(0,N._x)("New Variant","command","nelio-ab-testing")),!i&&!a&&o.createElement(w.ExternalLink,{className:"components-button is-secondary",href:(0,g.addFreeTracker)((0,N._x)("https://neliosoftware.com/testing/pricing/","text","nelio-ab-testing"))},(0,N._x)("Subscribe to Add More Variants","user","nelio-ab-testing"))),o.createElement(dn,null))},vn=function(){return(0,s.useSelect)((function(e){return e(f).getAlternativeIds()}))},gn=function(){var e=(0,s.useDispatch)(f).addAlternatives;return function(){return e((0,g.createAlternative)())}},fn=function(){return L("status")[0].includes("paused")},bn=function(){return(0,s.useSelect)((function(e){return e(d.STORE_NAME).getPluginSetting("subscription")||!1}))},En=function(){return(0,s.useSelect)((function(e){return e(f).isTestedElementInvalid()}))},xn=function(){var e,t,n,r,i,a=(0,o.useState)([]),s=a[0],l=a[1],c=s.join(";"),m=vn(),d=m.join(";");return(0,o.useEffect)((function(){c!==d&&l(m)}),[c,d]),c!==d&&(e=d,t=c.split(";"),n=e.split(";"),r=(0,u.difference)(t,n),i=(0,u.difference)(n,t),!!r.length&&!!i.length)},hn=null!==(kt=null===T.store||void 0===T.store?void 0:T.store.name)&&void 0!==kt?kt:"core/notices",yn=function(){var e=Sn(),t=(0,s.useDispatch)(hn).removeNotice;return o.createElement("div",{className:"nab-edit-experiment-layout"},o.createElement(F,null),o.createElement(Z,null),o.createElement("div",{className:"nab-edit-experiment-layout__body"},o.createElement("div",{className:"nab-edit-experiment-layout__content",role:"region","aria-label":(0,N._x)("Editor content","text","nelio-ab-testing"),tabIndex:-1},!(0,g.isEmpty)(e)&&o.createElement(w.NoticeList,{className:"nab-edit-experiment-layout__notices",notices:e,onRemove:t}),o.createElement(le,null),o.createElement(pn,null),o.createElement(ze,null),o.createElement(wt,null)),o.createElement(en,null)))},Sn=function(){return(0,s.useSelect)((function(e){return e(hn).getNotices()}))},An=[{label:(0,N._x)("What is the original page or post of a test?","text","nelio-ab-testing"),link:(0,N._x)("https://neliosoftware.com/testing/help/what-is-the-original-page-or-post-of-a-test/","text","nelio-ab-testing")},{label:(0,N._x)("Why don’t all my posts/pages appear in the selection list when I’m creating a new test?","text","nelio-ab-testing"),link:(0,N._x)("https://neliosoftware.com/testing/help/why-dont-all-my-posts-appear-in-the-selection-list/","text","nelio-ab-testing")},{label:(0,N._x)("What is a conversion and what counts as one?","text","nelio-ab-testing"),link:(0,N._x)("https://neliosoftware.com/testing/help/what-is-a-conversion/","text","nelio-ab-testing")},{label:(0,N._x)("How can I track conversions occurring in third-party websites?","text","nelio-ab-testing"),link:(0,N._x)("https://neliosoftware.com/testing/help/how-can-i-track-conversions-occurring-in-third-party-websites/","text","nelio-ab-testing")}];function wn(e){var t,n,r,i,a=(0,s.select)(K.STORE_NAME).getExperimentType(e),o=(0,s.select)(d.STORE_NAME).isSubscribedTo;return[{title:(0,N._x)("Test Editor","text","nelio-ab-testing"),intro:(0,N._x)("Welcome to the Test Editor. Here you’ll be able to select the element you want to test and create one or more variants to find out which one converts the most. As you can see, it’s quite similar to WordPress’ Block Editor: there’s a header, a sidebar, and a main area.","user","nelio-ab-testing")},{title:(0,N._x)("Name","text","nelio-ab-testing"),intro:(0,N._x)("You’ll notice that all test types have a similar user interface. When creating a new test, you’ll first have to name it. Just type in a descriptive name that helps you identify the test in the future.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-title")}},{title:(0,N._x)("Variants","text","nelio-ab-testing"),intro:(0,N._x)("Next, there’s a “Control Version and Variants” section. Use it to (a) identify the element you want to test and (b) create one or more split testing variants.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__alternative-section")}},{title:(0,N._x)("Variant A","text","nelio-ab-testing"),intro:null!==(n=null===(t=null==a?void 0:a.help)||void 0===t?void 0:t.original)&&void 0!==n?n:"",element:function(){return document.querySelector(".nab-alternative-list__alternative--original")},active:function(){var e;return!!(null===(e=null==a?void 0:a.help)||void 0===e?void 0:e.original)}},{title:(0,N._x)("Variant B","text","nelio-ab-testing"),intro:null!==(i=null===(r=null==a?void 0:a.help)||void 0===r?void 0:r.alternative)&&void 0!==i?i:"",element:function(){return document.querySelector(".nab-alternative-list__alternative:not(.nab-alternative-list__alternative--original)")},active:function(){var e;return!!(null===(e=null==a?void 0:a.help)||void 0===e?void 0:e.alternative)&&!!document.querySelector(".nab-alternative-list__alternative:not(.nab-alternative-list__alternative--original)")}},{title:(0,N._x)("Goals","text","nelio-ab-testing"),intro:(0,N._x)("Split tests help you to improve the conversion rate of your website. Here you can set up the goals a test pursues and the specific conversion actions that, when performed by a visitor, will trigger a conversion.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__goal-section")},active:function(){var e;return!(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.automaticGoalSetup)}},{title:(0,N._x)("Goals","text","nelio-ab-testing"),intro:(0,N._x)("Split tests help you to improve the conversion rate of your website. With this type of test, the conversion goal and conversion action that might trigger a conversion is already set up by Nelio A/B Testing.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__goal-section")},active:function(){var e;return!!(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.automaticGoalSetup)}},{title:(0,N._x)("Actions","text","nelio-ab-testing"),intro:(0,N._x)("Use these buttons to add the specific conversion actions that might trigger a conversion like, for example, “visiting a page” or “clicking an element on the page.”","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-conversion-action-type-list")},active:function(){return!!document.querySelector(".nab-conversion-action-type-list")}},{title:(0,N._x)("Segmentation","text","nelio-ab-testing"),intro:(0,N._x)("If you subscribe to Nelio A/B Testing, you’ll be able to segment your visitors into groups and specify who may or may not participate in a test.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__segmentation-section")},active:function(){return!!document.querySelector(".nab-edit-experiment-segmentation-section__content--free")}},{title:(0,N._x)("Segmentation","text","nelio-ab-testing"),intro:(0,N._x)("You can segment your audience into different groups and look at the performance of your split test with respect to each group. You can also use segmentation to limit who may or may not participate in a test.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-edit-experiment__segmentation-section")},active:function(){return!document.querySelector(".nab-edit-experiment-segmentation-section__content--free")}},{title:(0,N._x)("Status","text","nelio-ab-testing"),intro:(0,N._x)("Here you can see the current status of your test: once it’s “Ready,” you’ll be able to start it. Also, if you subscribe to our Professional plan, you’ll be able to schedule when a test should be started, as well as to define if and when it should be automatically stopped.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-management")},active:function(){return!o("professional")}},{title:(0,N._x)("Status","text","nelio-ab-testing"),intro:(0,N._x)("Here you can see the current status of your test: once it’s “Ready,” you’ll be able to start it. You can also schedule when the test should be started, as well as define a stop condition to automatically stop the test.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-management")},active:function(){return o("professional")}},{title:(0,N._x)("Scope","text","nelio-ab-testing"),intro:(0,N._x)("By default, this type of test will show up on all pages of your website. You can limit its scope by specifying the URLs in which the test should be visible.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-scope")},active:function(){var e,t;return"custom"===(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.scope)||"custom-with-tested-post"===(null===(t=null==a?void 0:a.supports)||void 0===t?void 0:t.scope)}},{title:(0,N._x)("Scope","text","nelio-ab-testing"),intro:(0,N._x)("This type of test applies to a specific element of your website, be it a page, a post, or what. If you enable “Global Consistency,” our plugin will also load the appropriate variant on any page in which the tested element (i.e. its title, featured image, and so on) shows up.","user","nelio-ab-testing"),element:function(){return document.querySelector(".nab-experiment-scope")},active:function(){var e;return"tested-post-with-consistency"===(null===(e=null==a?void 0:a.supports)||void 0===e?void 0:e.scope)}}]}var Nn=function(e){var t=e.experimentId,n=(0,s.useSelect)((function(e){return e(d.STORE_NAME).getExperiment(t)}));return(0,o.useEffect)((function(){var e;n&&(e=(0,s.select)(f).getExperimentType(),(0,Q.appendContextualHelp)({screen:"experiment-list:".concat(e),questions:An,walkthrough:wn(e)}))}),[!!n]),o.createElement(o.StrictMode,null,o.createElement(A,{experiment:n},o.createElement(yn,null)))},Tn=function(){return Tn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Tn.apply(this,arguments)},In={activeGoalId:"",activeSegmentId:"",alternativePreviewerUrl:"",draftStatusRationale:"",hasExperimentBeenRecentlySaved:!1,isExperimentBeingSaved:!1},Rn=function(){return Rn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Rn.apply(this,arguments)},On=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},Dn=b,Cn=function(){return Cn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Cn.apply(this,arguments)},kn=E,Pn=function(){return Pn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Pn.apply(this,arguments)},Mn=_,Gn=function(){return Gn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gn.apply(this,arguments)},Bn=x,Ln=function(){return Ln=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ln.apply(this,arguments)},Vn=h,Un=function(){return Un=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Un.apply(this,arguments)},jn=y,Fn=function(){return Fn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fn.apply(this,arguments)},qn=S;const Wn=(0,s.combineReducers)({editor:function(e,t){var n;return void 0===e&&(e=In),null!==(n=function(e,t){switch(t.type){case"SET_ACTIVE_GOAL":return Tn(Tn({},e),{activeGoalId:t.goalId});case"SET_ACTIVE_SEGMENT":return Tn(Tn({},e),{activeSegmentId:t.segmentId});case"SET_EXPERIMENT_AS_BEING_SAVED":return Tn(Tn({},e),{isExperimentBeingSaved:!!t.status});case"SET_EXPERIMENT_AS_RECENTLY_SAVED":return Tn(Tn({},e),{hasExperimentBeenRecentlySaved:!0});case"SET_DRAFT_STATUS_RATIONALE":return Tn(Tn({},e),{draftStatusRationale:t.rationale});case"OPEN_ALTERNATIVE_PREVIEWER":return Tn(Tn({},e),{alternativePreviewerUrl:t.url});case"CLOSE_ALTERNATIVE_PREVIEWER":return Tn(Tn({},e),{alternativePreviewerUrl:""});case"SETUP_EDITOR":return e}}(e=Tn(Tn({},e),{hasExperimentBeenRecentlySaved:!1}),t))&&void 0!==n?n:e},experiment:(0,s.combineReducers)({alternatives:function(e,t){var n;return void 0===e&&(e=Dn),null!==(n=function(e,t){var n;switch(t.type){case"ADD_ALTERNATIVES":return{byId:Rn(Rn({},e.byId),(0,u.keyBy)(t.alternatives,"id")),allIds:On(On([],e.allIds,!0),(0,u.map)(t.alternatives,"id"),!0)};case"REMOVE_ALTERNATIVES":return{byId:(0,u.omit)(e.byId,t.ids),allIds:(0,u.difference)(e.allIds,t.ids)};case"REPLACE_ALTERNATIVES":var r=(0,u.zip)(t.oldIds,(0,u.map)(t.alternatives,"id"));return{byId:Rn(Rn({},(0,u.omit)(e.byId,t.oldIds)),(0,u.keyBy)(t.alternatives,"id")),allIds:On(On([],e.allIds.map((function(e){var t=r.find((function(t){return t[0]===e}));return t?t[1]:e})).filter(g.isDefined),!0),r.filter((function(e){return!e[0]})).map((function(e){return e[1]})).filter(g.isDefined),!0)};case"SET_ALTERNATIVE":return!t.alternative||(0,g.isEmpty)(t.alternative)||(0,g.isEmpty)(e.byId[t.id])?e:Rn(Rn({},e),{byId:Rn(Rn({},e.byId),(n={},n[t.id]=t.alternative,n))});case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?Dn:{byId:(0,u.keyBy)(t.experiment.alternatives,"id"),allIds:(0,u.map)(t.experiment.alternatives,"id")}}}(e,t))&&void 0!==n?n:e},conversionActions:function(e,t){var n;return void 0===e&&(e=kn),null!==(n=function(e,t){var n,r,i,a,o;switch(t.type){case"ADD_CONVERSION_ACTIONS_INTO_GOAL":return Cn(Cn({},e),((n={})[t.goalId]=Cn(Cn({},e[t.goalId]),(0,u.keyBy)(t.conversionActions,"id")),n));case"REPLACE_CONVERSION_ACTIONS_IN_GOAL":return Cn(Cn({},e),((r={})[t.goalId]=Cn({},(0,u.keyBy)(t.conversionActions,"id")),r));case"UPDATE_CONVERSION_ACTION":var s=e[t.goalId];if(!s)return e;var l=s[t.conversionActionId];return l?Cn(Cn({},e),((i={})[t.goalId]=Cn(Cn({},s),((a={})[t.conversionActionId]=Cn(Cn({},l),{attributes:t.attributes?Cn(Cn({},l.attributes),t.attributes):l.attributes,scope:t.scope?t.scope:l.scope}),a)),i)):e;case"REMOVE_CONVERSION_ACTIONS_FROM_GOAL":return Cn(Cn({},e),((o={})[t.goalId]=(0,u.omit)(e[t.goalId],t.conversionActionIds),o));case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:t.experiment.goals.reduce((function(e,t){return e[t.id]=(0,u.keyBy)(t.conversionActions,"id"),e}),{})}}(e,t))&&void 0!==n?n:e},data:function(e,t){var n;return void 0===e&&(e=Mn),null!==(n=function(e,t){switch(t.type){case"UPDATE_EXPERIMENT_DATA":return Pn(Pn({},e),t.attributes);case"SET_TESTED_ELEMENT_AS_INVALID":return Pn(Pn({},e),{isTestedElementInvalid:!!t.invalid});case"SETUP_EDITOR":return Pn(Pn({},e),(0,u.omit)(t.experiment,["alternatives","goals","scope","segments"]))}}(e,t))&&void 0!==n?n:e},goals:function(e,t){var n;return void 0===e&&(e=Bn),null!==(n=function(e,t){var n;switch(t.type){case"ADD_GOALS":return Gn(Gn({},e),(0,u.keyBy)(t.goals,"id"));case"UPDATE_GOAL":var r=e[t.goalId];return r?Gn(Gn({},e),((n={})[t.goalId]=Gn(Gn({},r),{attributes:Gn(Gn({},r.attributes),t.attributes)}),n)):e;case"REMOVE_GOALS":return(0,u.omit)(e,t.ids);case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:(0,u.keyBy)(t.experiment.goals.map((function(e){return(0,u.omit)(e,"conversionActions")})),"id")}}(e,t))&&void 0!==n?n:e},scope:function(e,t){var n;return void 0===e&&(e=Vn),null!==(n=function(e,t){switch(t.type){case"ADD_SCOPE_RULES":return Ln(Ln({},e),(0,u.keyBy)(t.rules,"id"));case"REMOVE_SCOPE_RULES":return(0,u.omit)(e,t.ids);case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:(0,u.keyBy)(t.experiment.scope,"id")}}(e,t))&&void 0!==n?n:e},segmentationRules:function(e,t){var n;return void 0===e&&(e=jn),null!==(n=function(e,t){var n,r,i,a,o;switch(t.type){case"ADD_SEGMENTATION_RULES_INTO_SEGMENT":return Un(Un({},e),((n={})[t.segmentId]=Un(Un({},e[t.segmentId]),(0,u.keyBy)(t.segmentationRules,"id")),n));case"REPLACE_SEGMENTATION_RULES_IN_SEGMENT":return Un(Un({},e),((r={})[t.segmentId]=Un({},(0,u.keyBy)(t.segmentationRules,"id")),r));case"UPDATE_SEGMENTATION_RULE":var s=e[t.segmentId];if(!s)return e;var l=s[t.segmentationRuleId];return l?Un(Un({},e),((i={})[t.segmentId]=Un(Un({},s),((a={})[t.segmentationRuleId]=Un(Un({},l),{attributes:Un(Un({},l.attributes),t.attributes)}),a)),i)):e;case"REMOVE_SEGMENTATION_RULES_FROM_SEGMENT":return Un(Un({},e),((o={})[t.segmentId]=(0,u.omit)(e[t.segmentId],t.segmentationRuleIds),o));case"SETUP_EDITOR":return"nab/heatmap"===t.experiment.type?{}:t.experiment.segments.reduce((function(e,t){return e[t.id]=(0,u.keyBy)(t.segmentationRules,"id"),e}),{})}}(e,t))&&void 0!==n?n:e},segments:function(e,t){var n;return void 0===e&&(e=qn),null!==(n=function(e,t){var n;switch(t.type){case"ADD_SEGMENTS":return Fn(Fn({},e),(0,u.keyBy)(t.segments,"id"));case"UPDATE_SEGMENT":var r=e[t.segmentId];return r?Fn(Fn({},e),((n={})[t.segmentId]=Fn(Fn({},r),{attributes:Fn(Fn({},r.attributes),t.attributes)}),n)):e;case"REMOVE_SEGMENTS":return(0,u.omit)(e,t.ids);case"SETUP_EDITOR":if("nab/heatmap"===t.experiment.type)return{};var i=t.experiment.segments.map((function(e){return(0,u.omit)(e,"segmentationRules")}));return(0,u.keyBy)(i,"id")}}(e,t))&&void 0!==n?n:e}})});var Hn={};function Yn(e){return[e]}function $n(e,t,n){var r;if(e.length!==t.length)return!1;for(r=n;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Xn(e,t){var n,r=t||Yn;function i(){n=new WeakMap}function a(){var t,i,a,o,s,l=arguments.length;for(o=new Array(l),a=0;a<l;a++)o[a]=arguments[a];for(t=function(e){var t,r,i,a,o,s=n,l=!0;for(t=0;t<e.length;t++){if(!(o=r=e[t])||"object"!=typeof o){l=!1;break}s.has(r)?s=s.get(r):(i=new WeakMap,s.set(r,i),s=i)}return s.has(Hn)||((a=function(){var e={clear:function(){e.head=null}};return e}()).isUniqueByDependants=l,s.set(Hn,a)),s.get(Hn)}(s=r.apply(null,o)),t.isUniqueByDependants||(t.lastDependants&&!$n(s,t.lastDependants,0)&&t.clear(),t.lastDependants=s),i=t.head;i;){if($n(i.args,o,1))return i!==t.head&&(i.prev.next=i.next,i.next&&(i.next.prev=i.prev),i.next=t.head,i.prev=null,t.head.prev=i,t.head=i),i.val;i=i.next}return i={val:e.apply(null,o)},o[0]=null,i.args=o,t.head&&(t.head.prev=i,i.next=t.head),t.head=i,i.val}return a.getDependants=r,a.clear=i,i(),a}function zn(e,t){return e.experiment.alternatives.byId[t]}var Jn=Xn((function(e){return(0,u.values)(e.experiment.alternatives.byId)}),(function(e){return[e.experiment.alternatives.byId]})),Qn=function(e){return e.experiment.alternatives.allIds},Kn=Xn((function(e,t){return(0,u.values)(e.experiment.conversionActions[t])}),(function(e,t){return[e.experiment.conversionActions,t]}));function Zn(e){return!!e.editor.isExperimentBeingSaved}function er(e){return!!e.editor.hasExperimentBeenRecentlySaved}function tr(e){return(0,u.filter)(e.experiment.goals,{id:e.editor.activeGoalId})[0]||e.experiment.goals[0]}function nr(e){return(0,u.map)(e.experiment.goals,"id").indexOf(e.editor.activeGoalId)||0}function rr(e){return(0,u.filter)(e.experiment.segments,{id:e.editor.activeSegmentId})[0]}function ir(e){return(0,u.map)(e.experiment.segments,"id").indexOf(e.editor.activeSegmentId)||0}function ar(e){if(e.experiment&&e.experiment.data&&["draft","paused_draft"].includes(e.experiment.data.status))return e.editor.draftStatusRationale}function or(e){return e.editor.alternativePreviewerUrl}function sr(e){return e.experiment.data.id}function lr(e){return e.experiment.data.type}function cr(e,t){return e.experiment.data[t]}function ur(e,t){return e.experiment.data[t]}function mr(e){return!!e.experiment.data.isTestedElementInvalid}var dr=Xn((function(e){return(0,u.values)(e.experiment.goals)}),(function(e){return[e.experiment.goals]})),pr=Xn((function(e){return(0,u.values)(e.experiment.scope)}),(function(e){return[e.experiment.scope]})),vr=Xn((function(e,t){return(0,u.values)(e.experiment.segmentationRules[t])}),(function(e,t){return[e.experiment.segmentationRules,t]})),gr=Xn((function(e){return(0,u.values)(e.experiment.segments)}),(function(e){return[e.experiment.segments]}));function fr(e){return{type:"ADD_ALTERNATIVES",alternatives:(0,u.castArray)(e)}}function br(e){return{type:"REMOVE_ALTERNATIVES",ids:(0,u.castArray)(e)}}function Er(e,t){return{type:"REPLACE_ALTERNATIVES",oldIds:(0,u.castArray)(e),alternatives:(0,u.castArray)(t)}}function _r(e,t){return{type:"SET_ALTERNATIVE",id:e,alternative:t}}function xr(e,t){return{type:"ADD_CONVERSION_ACTIONS_INTO_GOAL",goalId:e,conversionActions:(0,u.castArray)(t)}}function hr(e,t){return{type:"REPLACE_CONVERSION_ACTIONS_IN_GOAL",goalId:e,conversionActions:(0,u.castArray)(t)}}function yr(e,t){return{type:"REMOVE_CONVERSION_ACTIONS_FROM_GOAL",goalId:e,conversionActionIds:(0,u.castArray)(t)}}function Sr(e,t,n,r){return{type:"UPDATE_CONVERSION_ACTION",goalId:e,conversionActionId:t,attributes:n,scope:r}}function Ar(e){return{type:"SETUP_EDITOR",experiment:e}}function wr(e){return{type:"SET_ACTIVE_GOAL",goalId:e}}function Nr(e){return{type:"SET_ACTIVE_SEGMENT",segmentId:e}}function Tr(e){return{type:"SET_EXPERIMENT_AS_BEING_SAVED",status:e}}function Ir(e){return{type:"SET_DRAFT_STATUS_RATIONALE",rationale:e}}function Rr(){return{type:"SET_EXPERIMENT_AS_RECENTLY_SAVED"}}function Or(e){return{type:"OPEN_ALTERNATIVE_PREVIEWER",url:e}}function Dr(){return{type:"CLOSE_ALTERNATIVE_PREVIEWER"}}function Cr(e){return{type:"UPDATE_EXPERIMENT_DATA",attributes:e}}function kr(e){return{type:"UPDATE_EXPERIMENT_DATA",attributes:e}}function Pr(e){return{type:"SET_TESTED_ELEMENT_AS_INVALID",invalid:e}}function Mr(e){return{type:"ADD_GOALS",goals:(0,u.castArray)(e)}}function Gr(e){return{type:"REMOVE_GOALS",ids:(0,u.castArray)(e)}}function Br(e,t){return{type:"UPDATE_GOAL",goalId:e,attributes:t}}function Lr(e){return{type:"ADD_SCOPE_RULES",rules:(0,u.castArray)(e)}}function Vr(e){return{type:"REMOVE_SCOPE_RULES",ids:(0,u.castArray)(e)}}function Ur(e,t){return{type:"ADD_SEGMENTATION_RULES_INTO_SEGMENT",segmentId:e,segmentationRules:(0,u.castArray)(t)}}function jr(e,t){return{type:"REPLACE_SEGMENTATION_RULES_IN_SEGMENT",segmentId:e,segmentationRules:(0,u.castArray)(t)}}function Fr(e,t){return{type:"REMOVE_SEGMENTATION_RULES_FROM_SEGMENT",segmentId:e,segmentationRuleIds:(0,u.castArray)(t)}}function qr(e,t,n){return{type:"UPDATE_SEGMENTATION_RULE",segmentId:e,segmentationRuleId:t,attributes:n}}function Wr(e){return{type:"ADD_SEGMENTS",segments:(0,u.castArray)(e)}}function Hr(e){return{type:"REMOVE_SEGMENTS",ids:(0,u.castArray)(e)}}function Yr(e,t){return{type:"UPDATE_SEGMENT",segmentId:e,attributes:t}}const $r=window.wp.apiFetch;var Xr=n.n($r);const zr=window.wp.date,Jr=window.wp.url;var Qr=function(){return Qr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Qr.apply(this,arguments)};const Kr=function(e){var t=e.url,n=e.path,r=(0,zr.format)("YmjHi").substring(0,11)+"0";return Xr()(Qr(Qr(Qr({},e),t&&{url:ei(e)?(0,Jr.addQueryArgs)(t,{nabts:r}):t}),n&&{path:(0,Jr.addQueryArgs)(n,{nabts:r})}))};var Zr,ei=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")},ti=function(){return ti=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ti.apply(this,arguments)},ni=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))},ri=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ii=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},ai=null!==(Zr=null===T.store||void 0===T.store?void 0:T.store.name)&&void 0!==Zr?Zr:"core/notices";function oi(){var e,t,n,r,i;return ni(this,void 0,void 0,(function(){var a,o,l,c,u,m,d,p,v,g,b,E,_,x,h,y,S,A,w,N,T,I,R,O,D;return ri(this,(function(C){switch(C.label){case 0:if((0,s.select)(f).isExperimentBeingSaved())return[2];for((0,s.dispatch)(f).setExperimentAsBeingSaved(!0),a=[],o=(0,s.select)(f).getGoals(),l=0,c=o;l<c.length;l++)u=c[l],m=(0,s.select)(f).getConversionActions(u.id),d=pi(m),a.push(ti(ti({},u),{attributes:ti(ti({},u.attributes),{useOrderRevenue:d?null===(e=u.attributes.useOrderRevenue)||void 0===e||e:void 0,orderStatusForConversion:d?vi(d,u):void 0}),conversionActions:m}));for(p=[],v=(0,s.select)(f).getSegments(),g=0,b=v;g<b.length;g++)E=b[g],p.push(ti(ti({},E),{segmentationRules:(0,s.select)(f).getSegmentationRules(E.id)}));for(_=[],x=(0,s.select)(f).getAlternativeIds(),h=(0,s.select)(f).isTestedElementInvalid(),y=(0,s.select)(f).getAlternative("control"),S=0,A=x;S<A.length;S++)"control"!==(w=A[S])&&(N=(0,s.select)(f).getAlternative(w))&&_.push(N);I=(0,s.select)(f).getExperimentType(),T="nab/heatmap"===I?{id:(0,s.select)(f).getExperimentId(),type:I,name:(0,s.select)(f).getExperimentAttribute("name"),description:(0,s.select)(f).getExperimentAttribute("description"),status:(0,s.select)(f).getExperimentAttribute("status"),startDate:(0,s.select)(f).getExperimentAttribute("startDate"),endDate:!1,endMode:(0,s.select)(f).getExperimentAttribute("endMode"),endValue:(0,s.select)(f).getExperimentAttribute("endValue"),trackingMode:null!==(t=(0,s.select)(f).getHeatmapAttribute("trackingMode"))&&void 0!==t?t:"post",trackedPostId:null!==(n=(0,s.select)(f).getHeatmapAttribute("trackedPostId"))&&void 0!==n?n:0,trackedPostType:null!==(r=(0,s.select)(f).getHeatmapAttribute("trackedPostType"))&&void 0!==r?r:"page",trackedUrl:null!==(i=(0,s.select)(f).getHeatmapAttribute("trackedUrl"))&&void 0!==i?i:""}:{id:(0,s.select)(f).getExperimentId(),type:I,name:(0,s.select)(f).getExperimentAttribute("name"),description:(0,s.select)(f).getExperimentAttribute("description"),status:(0,s.select)(f).getExperimentAttribute("status"),startDate:(0,s.select)(f).getExperimentAttribute("startDate"),endDate:!1,endMode:(0,s.select)(f).getExperimentAttribute("endMode"),endValue:(0,s.select)(f).getExperimentAttribute("endValue"),scope:(0,s.select)(f).getScope(),alternatives:h?[y]:ii([y],_,!0),goals:a,segments:p},C.label=1;case 1:return C.trys.push([1,3,,4]),[4,Kr({path:"/nab/v1/experiment/".concat(T.id),method:"PUT",data:T})];case 2:return R=C.sent(),"nab/heatmap"!==T.type&&h&&(R=ti(ti({},R),{alternatives:ii([R.alternatives[0]],_,!0)})),(0,s.dispatch)(f).setupEditor(R),(0,s.dispatch)(f).setExperimentAsBeingSaved(!1),(0,s.dispatch)(f).setExperimentAsRecentlySaved(),[3,4];case 3:return O=C.sent(),D=gi(O),(0,s.dispatch)(ai).createErrorNotice(D),(0,s.dispatch)(f).setExperimentAsBeingSaved(!1),[3,4];case 4:return[2]}}))}))}function si(e){return ni(this,void 0,void 0,(function(){var t;return ri(this,(function(n){switch(n.label){case 0:return[4,oi()];case 1:return n.sent(),(0,s.select)(f).hasExperimentBeenRecentlySaved()&&(0,s.select)(f).getAlternativeIds().includes(e)&&(t=(0,s.select)(f).getAlternative(e))&&t.links.edit?(window.location.href=t.links.edit,[2]):[2]}}))}))}function li(e){return ni(this,void 0,void 0,(function(){var t;return ri(this,(function(n){switch(n.label){case 0:return[4,oi()];case 1:return n.sent(),(0,s.select)(f).hasExperimentBeenRecentlySaved()&&(0,s.select)(f).getAlternativeIds().includes(e)&&(null==(t=(0,s.select)(f).getAlternative(e))?void 0:t.links.preview)?((0,s.dispatch)(f).openAlternativePreviewer(t.links.preview),[2]):[2]}}))}))}function ci(){return ni(this,void 0,void 0,(function(){return ri(this,(function(e){switch(e.label){case 0:return(0,s.dispatch)(f).setExperimentData({status:"trash"}),[4,oi()];case 1:return e.sent(),window.location.href=(0,s.select)(d.STORE_NAME).getAdminUrl("edit.php",{post_type:"nab_experiment"}),[2]}}))}))}function ui(){return ni(this,void 0,void 0,(function(){return ri(this,(function(e){switch(e.label){case 0:return[4,di("start",(0,N._x)("Test can’t be started","text","nelio-ab-testing"))];case 1:return e.sent(),[2]}}))}))}function mi(){return ni(this,void 0,void 0,(function(){return ri(this,(function(e){switch(e.label){case 0:return[4,di("resume",(0,N._x)("Test can’t be resumed","text","nelio-ab-testing"))];case 1:return e.sent(),[2]}}))}))}function di(e,t){return ni(this,void 0,void 0,(function(){var n,r,i;return ri(this,(function(a){switch(a.label){case 0:return[4,oi()];case 1:if(a.sent(),!(0,s.select)(f).hasExperimentBeenRecentlySaved())return[2];(0,s.dispatch)(f).setExperimentAsBeingSaved(!0),n=(0,s.select)(f).getExperimentId(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,Kr({path:"/nab/v1/experiment/".concat(n,"/").concat(e),method:"PUT"})];case 3:return a.sent(),[3,5];case 4:return r=a.sent(),i=gi(r,t),(0,s.dispatch)(ai).createErrorNotice(i),(0,s.dispatch)(f).setExperimentAsBeingSaved(!1),[2];case 5:return window.location.href=(0,s.select)(d.STORE_NAME).getAdminUrl("admin.php",{page:"nelio-ab-testing-experiment-view",experiment:n}),[2]}}))}))}function pi(e){if(e.length)return e.every((function(e){return"nab/wc-order"===e.type}))?"woocommerce":e.every((function(e){return"nab/edd-order"===e.type}))?"edd":void 0}function vi(e,t){var n=(0,s.select)(d.STORE_NAME).getECommerceSetting(e,"orderStatuses"),r=t.attributes.orderStatusForConversion;return r&&n.map((function(e){return e.value})).includes(r)?r:function(e){switch(e){case"woocommerce":return"wc-completed";case"edd":return"complete"}}(e)}function gi(e,t){return(e.errors?(0,u.values)(e.errors):[])[0]||e.message||t||(0,N._x)("Unknown error","text","nelio-ab-testing")}var fi=function(){return fi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fi.apply(this,arguments)},bi=fi(fi({},t),i);function Ei(e,t){var n,r,i=document.getElementById(e);i?((0,p.registerCoreExperiments)(),(0,m.registerCoreConversionActions)(),(0,v.registerCoreSegmentationRules)(),n=o.createElement(Nn,{experimentId:t}),(r=i)&&(o.createRoot?(0,o.createRoot)(r).render(n):(0,o.render)(n,r))):console.warn("Unable to find container node ".concat(e,"."))}function _i(){var e=window.innerHeight,t=document.getElementById("wpadminbar"),n=t?t.getBoundingClientRect().height:0;(0,(0,s.dispatch)(d.STORE_NAME).setPageAttribute)("sidebarDimensions",{top:n,height:"".concat(e-n,"px"),applyFix:782<=window.innerWidth})}(0,s.registerStore)(f,{reducer:Wn,controls:s.controls,actions:bi,selectors:e}),window.addEventListener("resize",(0,u.debounce)(_i,100)),c(_i)})();var i=nab="undefined"==typeof nab?{}:nab;for(var a in r)i[a]=r[a];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();