(()=>{var e={4184:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var i=typeof n;if("string"===i||"number"===i)e.push(n);else if(Array.isArray(n)){if(n.length){var s=a.apply(null,n);s&&e.push(s)}}else if("object"===i){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var o in n)r.call(n,o)&&n[o]&&e.push(o)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),window.wp.coreData,window.wp.domReady;const e=window.nab.data,t=window.wp.element,a=window.nab.experimentLibrary,i=window.wp.data,s=window.nab.editor,o=window.wp.url;var c=n(4184),l=n.n(c);const d=window.lodash,u=window.nab.utils,m=window.wp.components,v=window.wp.i18n;var b=function(){var e=p(),n=f(),r=n[0],a=n[1];return t.createElement("div",{className:"nab-css-editor-sidebar__actions"},t.createElement("div",{className:"nab-css-editor-sidebar__back-to-experiment"},t.createElement("a",{className:"nab-css-editor-sidebar__back-to-experiment-link",href:e,title:(0,v._x)("Back to test…","command","nelio-ab-testing")},t.createElement(m.Dashicon,{icon:"arrow-left-alt2"}))),t.createElement("div",{className:"nab-css-editor-sidebar__save-info"},r&&t.createElement("span",{className:"nab-css-editor-sidebar__saving-label"},t.createElement(m.Dashicon,{icon:"cloud"}),(0,v._x)("Saving…","text","nelio-ab-testing")),t.createElement(m.Button,{variant:"primary",disabled:r,onClick:a},(0,v._x)("Save","command","nelio-ab-testing"))))},p=function(){return(0,i.useSelect)((function(e){var t;return null===(t=e(s.STORE_NAME).getExperimentAttribute("links"))||void 0===t?void 0:t.edit}))},f=function(){return[(0,i.useSelect)((function(e){return e(s.STORE_NAME).isExperimentBeingSaved()})),(0,i.useDispatch)(s.STORE_NAME).saveExperiment]},_=function(e){var n=e.className,r=e.value,a=e.onChange;return t.createElement(m.TextareaControl,{className:n,value:r,onChange:a,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"})},E=function(){var n=(0,e.usePageAttribute)("css-preview/areControlsVisible",!0),r=n[0],a=n[1],i=(0,e.usePageAttribute)("css-preview/activeResolution","desktop"),s=i[0],o=i[1];return t.createElement("div",{className:"nab-css-editor-sidebar__footer-actions"},t.createElement("div",{className:l()({"nab-css-editor-sidebar__visibility-toggle":!0,"nab-css-editor-sidebar__visibility-toggle--hide":!!r,"nab-css-editor-sidebar__visibility-toggle--show":!r})},t.createElement(m.Button,{variant:"link",onClick:function(){return a(!r)}},r?t.createElement(t.Fragment,null,t.createElement(m.Dashicon,{icon:"admin-collapse"}),t.createElement("span",{className:"nab-css-editor-sidebar__visibility-toggle-label"},(0,v._x)("Hide Controls","command","nelio-ab-testing"))):t.createElement(m.Dashicon,{icon:"admin-collapse"}))),t.createElement("div",{className:"nab-css-editor-sidebar__resolutions"},t.createElement("div",{className:l()({"nab-css-editor-sidebar__resolution":!0,"nab-css-editor-sidebar__resolution--is-active":"desktop"===s})},t.createElement(m.Button,{variant:"link",onClick:function(){return o("desktop")}},t.createElement(m.Dashicon,{icon:"desktop"}),t.createElement("span",{className:"screen-reader-text"},(0,v._x)("Enter desktop preview mode","command","nelio-ab-testing")))),t.createElement("div",{className:l()({"nab-css-editor-sidebar__resolution":!0,"nab-css-editor-sidebar__resolution--is-active":"tablet"===s})},t.createElement(m.Button,{variant:"link",onClick:function(){return o("tablet")}},t.createElement(m.Dashicon,{icon:"tablet"}),t.createElement("span",{className:"screen-reader-text"},(0,v._x)("Enter tablet preview mode","command","nelio-ab-testing")))),t.createElement("div",{className:l()({"nab-css-editor-sidebar__resolution":!0,"nab-css-editor-sidebar__resolution--is-active":"mobile"===s})},t.createElement(m.Button,{variant:"link",onClick:function(){return o("mobile")}},t.createElement(m.Dashicon,{icon:"smartphone"}),t.createElement("span",{className:"screen-reader-text"},(0,v._x)("Enter mobile preview mode","command","nelio-ab-testing"))))))},w=function(){return w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},w.apply(this,arguments)},g=function(e){var n=e.className,r=e.alternativeId,a=y(r),i=a[0],s=a[1];return t.createElement("div",{className:l()(["nab-css-editor-sidebar",n])},t.createElement(b,null),t.createElement(_,{className:"nab-css-editor-sidebar__editor",value:i,onChange:s}),t.createElement(E,null))},y=function(e){var t,n=(0,i.useSelect)((function(t){return t(s.STORE_NAME).getAlternative(e)})),r=(null===(t=null==n?void 0:n.attributes)||void 0===t?void 0:t.css)||"",a=(0,i.useDispatch)(s.STORE_NAME).setAlternative;return[r,function(e){n&&a(n.id,w(w({},n),{attributes:(0,u.omitUndefineds)(w(w({},n.attributes),{css:e}))}))}]};const x=window.wp.compose;var N,h=function(n){var r=n.className,a=n.previewUrl,i=n.value,s=(0,x.useInstanceId)(h),o=(0,e.usePageAttribute)("css-preview/activeResolution","desktop")[0],c=S(s,i);return t.createElement("div",{className:l()([r,"nab-css-preview"])},t.createElement("iframe",{id:"nab-css-previewer__iframe-".concat(s),className:l()(["nab-css-preview__iframe","nab-css-preview__iframe--".concat(o)]),title:(0,v._x)("CSS Preview","text","nelio-ab-testing"),onLoad:c,src:a}))},S=function(e,n){var r=(0,t.useState)(),a=r[0],i=r[1],s=function(){clearTimeout(a),i(setTimeout((function(){var t,r=document.getElementById("nab-css-previewer__iframe-".concat(e));(null===(t=null==r?void 0:r.contentWindow)||void 0===t?void 0:t.postMessage)&&r.contentWindow.postMessage({type:"css-preview",value:n})}),500))};return(0,t.useEffect)(s,[n]),s},k=function(n){var r=n.alternativeId,a=(0,e.usePageAttribute)("css-preview/areControlsVisible",!0)[0],i=A(r),s=O();return t.createElement("div",{className:"nab-css-editor"},t.createElement(g,{className:l()({"nab-css-editor__sidebar":!0,"nab-css-editor__sidebar--is-collapsed":!a}),alternativeId:r}),t.createElement(h,{key:"nab-css-editor__preview",className:l()({"nab-css-editor__preview":!0,"nab-css-editor__preview--is-fullscreen":!a}),previewUrl:s,value:i}))},A=function(e){return(0,i.useSelect)((function(t){var n,r;return(null===(r=null===(n=t(s.STORE_NAME).getAlternative(e))||void 0===n?void 0:n.attributes)||void 0===r?void 0:r.css)||""}))},O=function(){return(0,i.useSelect)((function(e){var t=(0,e(s.STORE_NAME).getAlternative)("control");if(t){var n=e(s.STORE_NAME),r=n.getAlternatives,a=n.getExperimentId,i=(0,o.getQueryArgs)(document.location.href).alternative||"",c=r(),l=a(),u=(0,d.indexOf)((0,d.map)(c,"id"),i),m=t.links&&t.links.preview||"/",v=(0,o.removeQueryArgs)(m,"nab-preview","experiment","alternative","timestamp","nabnonce");return(0,o.addQueryArgs)(v,{"nab-css-previewer":"".concat(l,":").concat(u)})}}))},C=function(n){var r=n.experimentId,a=n.alternativeId,o=(0,i.useSelect)((function(t){return t(e.STORE_NAME).getExperiment(r)}));return o?t.createElement(t.StrictMode,null,t.createElement(s.EditorProvider,{experiment:o},t.createElement(k,{alternativeId:a}))):null},M=function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},M.apply(this,arguments)};window.nab=M(M({},(N=window)&&"object"==typeof N&&"nab"in N?window.nab:{}),{initCssEditorPage:function(e,n){(0,a.registerCoreExperiments)();var r=document.getElementById(e);if(r){var i,s,o=n.experimentId,c=n.alternativeId;i=t.createElement(C,{experimentId:o,alternativeId:c}),(s=r)&&(t.createRoot?(0,t.createRoot)(s).render(i):(0,t.render)(i,s))}}})})();var a=nab="undefined"==typeof nab?{}:nab;for(var i in r)a[i]=r[i];r.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();