(()=>{var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t);const n=window.nab.data,i=window.wp.element,r=window.nab.experimentLibrary,a=window.wp.apiFetch;var o=e.n(a);const l=window.wp.date,s=window.wp.url;var c=function(){return c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},c.apply(this,arguments)};var d=function(e){var t,n;return!!(null===(t=e.url)||void 0===t?void 0:t.includes("/wp-json/"))||!!(null===(n=e.url)||void 0===n?void 0:n.includes("rest_route"))||!!Object.keys(e).includes("rest_route")};const u=window.wp.components,m=window.wp.data,p=window.wp.i18n,b=window.lodash,v=window.nab.components,f=window.nab.experiments,E=window.nab.utils;var g=function(){return g=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},g.apply(this,arguments)},w=function(e){var t=e.experimentId,n=e.postBeingEdited,r=e.type,a=N(t);return a?i.createElement(i.Fragment,null,i.createElement(_,{icon:a,experimentId:t}),i.createElement(x,{experimentId:t,postBeingEdited:n}),i.createElement(y,{postBeingEdited:n,type:r})):null},_=function(e){var t=e.icon,n=e.experimentId,r=I(n),a=h(n);return i.createElement(u.PanelRow,{className:"nab-test-panel"},i.createElement("span",{className:"nab-test-panel__icon"},i.createElement(t,null)),i.createElement("a",{className:"nab-test-panel__name",href:a},r))},x=function(e){var t=e.experimentId,n=e.postBeingEdited,r=O(t);return r?i.createElement(u.PanelRow,{className:"nab-variants-panel"},i.createElement("h2",{className:"nab-variants-panel__title"},(0,p._x)("Variants","text","nelio-ab-testing")),r.map((function(e){var t=e.name,r=e.link,a=e.postId,o=e.index;return i.createElement("div",{className:"nab-alternative",key:a},i.createElement("span",{className:"nab-alternative__letter"},(0,E.getLetter)(o)),i.createElement("span",{className:"nab-alternative__name"},n!==a?i.createElement("a",{href:r},B(t,o)):i.createElement("strong",null,B(t,o))))}))):null},y=function(e){var t=e.postBeingEdited,n=e.type,r=C(t),a=r[0],o=r[1],l=(0,i.useState)(j),s=l[0],c=l[1],d=function(e){return c(g(g({},s),e))},m=s.isImportEnabled,b=s.isConfirmationDialogVisible,f=s.postIdToImportFrom,E=function(){return d({isImportEnabled:!m})},w=function(){return d({isConfirmationDialogVisible:!b})},_=a?(0,p._x)("Importingâ€¦","text","nelio-ab-testing"):(0,p._x)("Import","command","nelio-ab-testing");return i.createElement(u.PanelRow,{className:"nab-content-panel"},i.createElement("h2",{className:"nab-content-panel__title"},(0,p._x)("Content","text","nelio-ab-testing")),i.createElement("span",{className:"nab-content-panel__label"},i.createElement(u.Dashicon,{icon:"admin-page"}),m?(0,p._x)("Import content from:","text","nelio-ab-testing"):i.createElement(u.Button,{variant:"link",onClick:E},(0,p._x)("Import Content","command","nelio-ab-testing"))),m&&i.createElement(i.Fragment,null,i.createElement(v.PostSearcher,{value:f,className:"nab-content-panel__searcher",type:n,onChange:function(e){return void 0===e&&(e=0),d({postIdToImportFrom:e})}}),i.createElement("div",{className:"nab-content-panel__actions"},i.createElement(u.Button,{variant:"link",onClick:E},(0,p._x)("Cancel","command","nelio-ab-testing")),i.createElement(u.Button,{variant:"secondary",disabled:!f,onClick:w},(0,p._x)("Import","command","nelio-ab-testing")),i.createElement(v.ConfirmationDialog,{title:(0,p._x)("Import Content?","text","nelio-ab-testing"),text:(0,p._x)("This will overwrite the current content.","text","nelio-ab-testing"),confirmLabel:_,isConfirmEnabled:!a,isCancelEnabled:!a,isOpen:b,onCancel:w,onConfirm:function(){return o(f)}}))))},I=function(e){return(0,m.useSelect)((function(t){var i;return(null===(i=t(n.STORE_NAME).getExperiment(e))||void 0===i?void 0:i.name)||(0,p._x)("Unnamed Test","text","nelio-ab-testing")}))},h=function(e){return(0,m.useSelect)((function(t){var i;return(null===(i=t(n.STORE_NAME).getExperiment(e))||void 0===i?void 0:i.links.edit)||""}))},O=function(e){return(0,m.useSelect)((function(t){var i;return(0,b.map)(null===(i=t(n.STORE_NAME).getExperiment(e))||void 0===i?void 0:i.alternatives,(function(e,t){return{index:t,postId:P(e)?e.attributes.postId:0,name:S(e)?e.attributes.name:"",link:e.links.edit}}))}))},N=function(e){return(0,m.useSelect)((function(t){var r,a,o,l,s=t(n.STORE_NAME).getExperiment,c=t(f.STORE_NAME).getExperimentTypes,d=null!==(a=null===(r=s(e))||void 0===r?void 0:r.type)&&void 0!==a?a:"";return null!==(l=null===(o=c()[d])||void 0===o?void 0:o.icon)&&void 0!==l?l:function(){return i.createElement(i.Fragment,null)}}))},C=function(e){var t=(0,i.useState)(0),n=t[0],r=t[1];return(0,i.useEffect)((function(){var t,i,r,a;n&&(t={path:"/nab/v1/post/".concat(n,"/overwrites/").concat(e),method:"PUT"},i=t.url,r=t.path,a=(0,l.format)("YmjHi").substring(0,11)+"0",o()(c(c(c({},t),i&&{url:d(t)?(0,s.addQueryArgs)(i,{nabts:a}):i}),r&&{path:(0,s.addQueryArgs)(r,{nabts:a})}))).finally((function(){window.location.reload()}))}),[n]),[!!n,r]},P=function(e){return!!e.attributes.postId},S=function(e){return!!e.attributes.name},B=function(e,t){return e||(0===t?(0,p._x)("Control Version","text","nelio-ab-testing"):(0,p.sprintf)(/* translators: a letter, such as A, B, or C */
(0,p._x)("Variant %s","text","nelio-ab-testing"),(0,E.getLetter)(t)))},j={isImportEnabled:!1,isConfirmationDialogVisible:!1,postIdToImportFrom:0};const T=window.wp.plugins;var k,M,A,R=null===(M=null===(k=window.wp)||void 0===k?void 0:k.editPost)||void 0===M?void 0:M.PluginDocumentSettingPanel,F=R?function(e){var t=e.experimentId,n=e.postBeingEdited,r=e.type;return i.createElement(R,{className:"nab-alternative-editing-sidebar",title:(0,p._x)("Nelio A/B Testing","text","nelio-ab-testing"),icon:"none"},i.createElement(w,{experimentId:t,postBeingEdited:n,type:r}))}:function(){return null},D=function(){return D=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},D.apply(this,arguments)};window.nab=D(D({},(A=window)&&"object"==typeof A&&"nab"in A?window.nab:{}),{initEditPostAlternativeMetabox:function(e){(0,r.registerCoreExperiments)();var t,n,a=e.experimentId,o=e.postBeingEdited,l=e.type,s=document.getElementById("nelioab_edit_post_alternative_box"),c=null==s?void 0:s.getElementsByClassName("inside")[0];c&&(t=i.createElement(w,{experimentId:a,postBeingEdited:o,type:l}),(n=c)&&(i.createRoot?(0,i.createRoot)(n).render(t):(0,i.render)(t,n)))},initEditPostAlternativeBlockEditorSidebar:function(e){(0,r.registerCoreExperiments)();var t=e.experimentId,n=e.postBeingEdited,a=e.type;(0,T.registerPlugin)("nelio-ab-testing",{icon:function(){return i.createElement(i.Fragment,null)},render:function(){return i.createElement(F,{experimentId:t,postBeingEdited:n,type:a})}})}})})();var n=nab="undefined"==typeof nab?{}:nab;for(var i in t)n[i]=t[i];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();