(()=>{var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{"use strict";e.r(t),e.d(t,{segmentationRules:()=>o});var n={};e.r(n),e.d(n,{getSegmentationRuleType:()=>u,getSegmentationRuleTypeCategories:()=>c,getSegmentationRuleTypeCategory:()=>l,getSegmentationRuleTypes:()=>s});var r={};e.r(r),e.d(r,{addSegmentationRuleTypeCategories:()=>y,addSegmentationRuleTypes:()=>g,removeSegmentationRuleTypeCategories:()=>p,removeSegmentationRuleTypes:()=>m});var o={};e.r(o),e.d(o,{STORE_NAME:()=>d,createSegmentationRule:()=>A,registerSegmentationRuleType:()=>C,registerSegmentationRuleTypeCategory:()=>P});const a=window.wp.data,i=window.lodash;function s(e){return(0,i.values)(e.segmentationRuleTypes)}function u(e,t){return e.segmentationRuleTypes[t]}function c(e){return(0,i.values)(e.categories)}function l(e,t){return e.categories[t]}function g(e){return{type:"ADD_SEGMENTATION_RULE_TYPES",segmentationRuleTypes:(0,i.castArray)(e)}}function m(e){return{type:"REMOVE_SEGMENTATION_RULE_TYPES",names:(0,i.castArray)(e)}}function y(e){return{type:"ADD_SEGMENTATION_RULE_TYPE_CATEGORIES",categories:(0,i.castArray)(e)}}function p(e){return{type:"REMOVE_SEGMENTATION_RULE_TYPE_CATEGORIES",names:(0,i.castArray)(e)}}var f,d="nab/segmentation-rules",T={segmentationRuleTypes:{},categories:{}},E=function(){return E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},E.apply(this,arguments)};(0,a.registerStore)(d,{reducer:function(e,t){var n;return void 0===e&&(e=T),null!==(n=function(e,t){switch(t.type){case"ADD_SEGMENTATION_RULE_TYPES":return E(E({},e),{segmentationRuleTypes:E(E({},e.segmentationRuleTypes),(0,i.keyBy)(t.segmentationRuleTypes,"name"))});case"REMOVE_SEGMENTATION_RULE_TYPES":return E(E({},e),{segmentationRuleTypes:(0,i.omit)(e.segmentationRuleTypes,t.names)});case"ADD_SEGMENTATION_RULE_TYPE_CATEGORIES":return E(E({},e),{categories:E(E({},e.categories),(0,i.keyBy)(t.categories,"name"))});case"REMOVE_SEGMENTATION_RULE_TYPE_CATEGORIES":return E(E({},e),{categories:(0,i.omit)(e.categories,t.names)})}}(e,t))&&void 0!==n?n:e},selectors:n,actions:r});var S=new Uint8Array(16);function v(){if(!f&&!(f="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(S)}const R=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var h=[],b=0;b<256;++b)h.push((b+256).toString(16).substr(1));const _=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&R.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},O=function(e,t,n){var r=(e=e||{}).random||(e.rng||v)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return _(r)};var w=function(){return w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},w.apply(this,arguments)};function A(e,t){var n=(0,(0,a.select)(d).getSegmentationRuleType)(e);if(n)return{id:O(),type:e,attributes:w(w({},n.attributes),t||{})}}const M=window.nab.utils;var N=function(){return N=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},N.apply(this,arguments)};function C(e,t){if("string"==typeof e)if(/^[a-z][a-z0-9-]*\/[a-z][a-z0-9-]*$/.test(e))if((0,a.select)(d).getSegmentationRuleType(e))console.error("Segmentation rule “".concat(e,"” is already registered."));else if(I(t))if(j(t))if((0,M.isValidIcon)(t.icon))if(G(t))if(U(t))if(D(t)){if(V(t)){var n=N({name:e},t);return(0,a.dispatch)(d).addSegmentationRuleTypes(n),n}console.error("Segmentation rule “".concat(e,"” must have a category."))}else console.error("Segmentation rule “".concat(e,"” must have a title."));else console.error("The “edit” property must be a valid function.");else console.error("The “view” property must be a valid function.");else console.error("The icon passed is invalid. The icon should be an element or a function.");else console.error("Segmentation rule “".concat(e,"” must have an icon."));else console.error("Segmentation rule “".concat(e,"” should specify its default attributes."));else console.error("Segmentation rule names must contain a namespace prefix, include only lowercase alphanumeric characters or dashes, and start with a letter. Example: my-plugin/my-custom-segmentation-rule");else console.error("Segmentation rule names must be strings.")}function P(e,t){var n=N({name:e},t);if("string"==typeof e)if(/^[a-z][a-z0-9-]*\/[a-z][a-z0-9-]*$/.test(e))if((0,a.select)(d).getSegmentationRuleTypeCategory(e))console.error("Segmentation rule category “".concat(e,"” is already registered."));else if(j(n))if((0,M.isValidIcon)(n.icon)){if(D(n))return(0,a.dispatch)(d).addSegmentationRuleTypeCategories(n),n;console.error("Segmentation rule category “".concat(e,"” must have a title."))}else console.error("The icon passed is invalid. The icon should be an element or a function.");else console.error("Segmentation rule category “".concat(e,"” must have an icon."));else console.error("Segmentation rule category names must contain a namespace prefix, include only lowercase alphanumeric characters or dashes, and start with a letter. Example: my-plugin/my-custom-segmentation-rule-category");else console.error("Segmentation rule category names must be strings.")}var I=function(e){return!!e.attributes},j=function(e){return"icon"in e},G=function(e){return(0,i.isFunction)(e.view)},U=function(e){return(0,i.isFunction)(e.edit)},V=function(e){return!!e.category},D=function(e){return!!e.title}})();var n=nab="undefined"==typeof nab?{}:nab;for(var r in t)n[r]=t[r];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();